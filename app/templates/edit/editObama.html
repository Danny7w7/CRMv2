{% extends "dashboard/index.html" %}
{% load static %}
{% load userModules %}
{% block head %}
    <title>Client Obamacare</title>
	<!--plugins-->
	<link href="{% static 'assets/plugins/simplebar/css/simplebar.css' %}" rel="stylesheet"/>
	<link href="{% static 'assets/plugins/perfect-scrollbar/css/perfect-scrollbar.css' %}" rel="stylesheet"/>
	<link href="{% static 'assets/plugins/metismenu/css/metisMenu.min.css' %}" rel="stylesheet"/>
	<link href="{% static 'assets/plugins/datatable/css/dataTables.bootstrap5.min.css' %}" rel="stylesheet"/>
	<link href="{% static 'assets/plugins/bs-stepper/css/bs-stepper.css' %}" rel="stylesheet"/>	
	<!-- loader-->
	<link href="{% static 'assets/css/pace.min.css' %}" rel="stylesheet" />
	<script src="{% static 'assets/js/pace.min.js' %}"></script>
	<!-- Bootstrap CSS -->
	<link href="{% static 'assets/css/bootstrap.min.css' %}" rel="stylesheet">
	<link href="{% static 'assets/css/bootstrap-extended.css' %}" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&amp;display=swap" rel="stylesheet">
	<link href="{% static 'assets/css/app.css' %}" rel="stylesheet">
	<link href="{% static 'assets/css/icons.css' %}" rel="stylesheet">
	<!-- Theme Style CSS -->
	<link rel="stylesheet" href="{% static 'assets/css/dark-theme.css' %}" />
	<link rel="stylesheet" href="{% static 'assets/css/semi-dark.css' %}" />
	<link rel="stylesheet" href="{% static 'assets/css/header-colors.css' %}" />
	<!-- Choise Style CSS -->
	<link rel="stylesheet" href="{% static 'assets/css/choiseFromEdit.css' %}" />
	<link rel="stylesheet" href="{% static 'assets/css/styleCopyLinkConsent.css' %}" />

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <!-- Incluir FilePond plugins para imágenes -->
	<link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet">
    <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet">

	<!-- Custom styles -->
	<style>
		.centerAllExceptFirst td:not(:first-child),
		.centerAllExceptFirst th:not(:first-child) {
			text-align: center;
		}
	</style>

	<!-- Action Button Styles -->
	<style>
		.hover-lift {
			transition: all 0.3s ease;
		}
		.hover-lift:hover {
			transform: translateY(-2px);
			box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
		}
		.bg-light-info {
			background-color: rgba(13, 202, 240, 0.05) !important;
		}
		.bg-light-warning {
			background-color: rgba(255, 193, 7, 0.05) !important;
		}
		.bg-light-secondary {
			background-color: rgba(108, 117, 125, 0.05) !important;
		}
		.card {
			border-radius: 12px;
		}
		.btn {
			border-radius: 8px;
		}
		.rounded-3 {
			border-radius: 12px !important;
		}
	</style>
	<link rel="stylesheet" href="{% static 'assets/css/floatingSms.css' %}">
	
{% endblock %}
{% block page_content %}

	{% if temporalyURL %}
		<!-- Div flotante -->
		<div class="floating-container">
			<button class="copy-button" onclick="copyCurrentURL()">
				<i class="fas fa-link"></i>
				Copy Link Consent
			</button>
			<div class="success-message">¡Link copiado!</div>
		</div>
	{% endif %}


	<h6 class="mb-0 text-uppercase">Client obamacare</h6>
	<hr/>

	<div id="stepper1" class="bs-stepper">
		<div class="card">
			<div class="card-header">
				<div class="d-lg-flex flex-lg-row align-items-lg-center justify-content-lg-between" role="tablist">
					<div class="step {% if letterCard.letters and letterCard.card %}active{% endif %}">
						<div class="step-trigger d-flex flex-column align-items-center">
							<div class="bs-stepper-circle">
								<i class="fa-solid fa-file-signature"></i>
							</div>
							<h5 class="mb-0 steper-title">L & C</h5>
						</div>
					</div>

					<div class="bs-stepper-line"></div>

					<div class="step {% if userCarrier.username_carrier != Null and userCarrier.username_carrier != 'None' and userCarrier.username_carrier != '' %}active{% endif %}" >
						<div class="step-trigger d-flex flex-column align-items-center" role="tab">
							<div class="bs-stepper-circle">
								<i class="fa-solid fa-circle-user"></i>
							</div>
							<h5 class="mb-0 steper-title">User Carrier</h5>
						</div>
					</div>

					<div class="bs-stepper-line"></div>

					<div class="step {% if paymentDateObama %}active {% elif obamacare.premium == '0.00' %}active {% endif %} " >
						<div class="step-trigger d-flex flex-column align-items-center" role="tab">
							<div class="bs-stepper-circle">
								<i class="fa-solid fa-circle-user"></i>
							</div>
							<h5 class="mb-0 steper-title">Setup premium alert</h5>
						</div>
					</div>

					<div class="bs-stepper-line"></div>

					<div class="step {% if obamacare.status == 'ACTIVE' %}active{% endif %} " >
						<div class="step-trigger d-flex flex-column align-items-center" role="tab">
							<div class="bs-stepper-circle" >
								<i class="fa-solid fa-circle-check"></i>
							</div>
							<h5 class="mb-0 steper-title">Status</h5>
						</div>
					</div>

					<div class="bs-stepper-line"></div>

					<div class="step {% if obamacare.doc_income and obamacare.doc_migration%}active{% endif %}">
						<div class="step-trigger d-flex flex-column align-items-center" role="tab">
							<div class="bs-stepper-circle">
								<i class="fa-solid fa-file-invoice"></i>
							</div>
							<h5 class="mb-0 steper-title">Documents</h5>
						</div>
					</div>

					<div class="bs-stepper-line"></div>

					<div class="step {% if obamacare.policyNumber != '' and obamacare.policyNumber != Null and obamacare.policyNumber != 'None' %}active{% endif %}">
						<div class="step-trigger d-flex flex-column align-items-center" role="tab">
							<div class="bs-stepper-circle">
								<i class="bi bi-123"></i>
							</div>
							<h5 class="mb-0 steper-title">Policy Number</h5>
						</div>
					</div>

					<div class="bs-stepper-line"></div>

					<div class="step {% if apppointment %}active{% endif %}">
						<div class="step-trigger d-flex flex-column align-items-center" role="tab">
							<div class="bs-stepper-circle">
								<i class="fa-solid fa-user-doctor"></i>
							</div>
							<h5 class="mb-0 steper-title">Appointment</h5>
						</div>
					</div>
				</div>
				<hr>
				<div class="progress">
					<div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="{{percentage}}" aria-valuemin="0" aria-valuemax="100" style="width: {{percentage}}%">{{percentage}}%</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-xl-10 mx-auto">
			<div class="card">
				<div class="card-body p-4">

					<form class="row g-3 needs-validation" method="POST">
						<h4>Client</h4>						
							<div class="col-12 col-lg-4">
								<label for="first_name" class="form-label">First Name</label>
								<input type="text" class="form-control" name="first_name" id="first_name" placeholder="First Name" value="{{obamacare.client.first_name}}" required>
								<input class="form-control" hidden name="id_client" id="id_client"  value="{{obamacare.client.id}}">
							</div>
							<div class="col-12 col-lg-4">
								<label for="last_name" class="form-label">Last Name</label>
								<input type="text" class="form-control" name="last_name" id="last_name" placeholder="Last Name" value="{{obamacare.client.last_name}}" required>
							</div>
							<div class="col-12 col-lg-4">
								<label for="phone_number" class="form-label">Phone Number</label>
								<input readonly type="number" class="form-control" name ="phone_number" id="phone_number" placeholder="Phone Number" value="{{obamacare.client.phone_number}}" required>
							</div>
							<div class="col-12 col-lg-3">
								<label for="email" class="form-label">E-mail Address</label>
								<input type="email" class="form-control" name="email" id="email" placeholder="Enter Email Address" value="{{obamacare.client.email}}" required>
							</div>
							<div class="col-12 col-lg-3">
								<label for="address" class="form-label">Address</label>
								<input type="text" class="form-control" name="address" id="address" placeholder="Address" value="{{obamacare.client.address}}" required>
							</div>
							<div class="col-12 col-lg-2">
								<label for="zipcode" class="form-label">zipCode</label>
								<input type="text" maxlength="5" oninput="this.value = this.value.replace(/[^0-9]/g, '')" class="form-control" name ="zipcode" id="zipcode" value="{{obamacare.client.zipcode}}" required>
							</div>
							<div class="col-12 col-lg-2">
								<label for="city" class="form-label">City</label>
								<input type="text" class="form-control" name ="city" id="city" value="{{obamacare.client.city}}" readonly required>
							</div>
							<div class="col-12 col-lg-2">
								<label for="state" class="form-label font-weight-bold">State</label>
								<input type="text" class="form-control" name ="state" id="state" value="{{obamacare.client.state}}" readonly required>
							</div>
							<div class="col-12 col-lg-3">
								<label for="county" class="form-label">County</label>
								<input type="text" class="form-control" name ="county" id="county" value="{{obamacare.client.county}}" readonly required>
							</div>
							<div class="col-12 col-lg-2">
								<label for="sex" class="form-label">Sex</label>
								<select class="form-select"  name="sex" id="sex" aria-label="Default select example" required>
									<option value="" disabled selected>Please Select</option>
									<option value="M" {% if obamacare.client.sex == "M" %}selected{% endif %} >MALE</option>
									<option value="F" {% if obamacare.client.sex == "F" %}selected{% endif %} >FEMALE</option>
								</select>
							</div>
							<div class="col-12 col-lg-1">
								<label for="old" class="form-label">Age</label>
								<input type="number" class="form-control" name ="old" id="old" placeholder="Old" value="{{old}}" readonly >
							</div>
							<div class="col-12 col-lg-3">
								<label for="date_birth" class="form-label">Date Birth</label>
								<input type="text" class="form-control" name="date_birth" id="date_birth" value="{{ obamacare.client.date_birth|date:'m/d/Y' }}" required>
							</div>
							<div class="col-12 col-lg-3">
								<label for="social_security" class="form-label">Social Security</label>
								<div class="input-group">
									<input type="text" class="form-control" name="social_security" id="social_security" value="{{formatted_social}}"  disabled data-client-id="{{ obamacare.client.id }}">
									<button id="show-full-social" type="button" class="btn btn-secondary">
										<i class="lni lni-eye"></i>
									</button>
									<button hidden type="button" id="save-social" class="btn btn-success">
										<i class="lni lni-save"></i>
									</button>
									<button hidden type="button" id="block-social" class="btn btn-danger">
										<i class="lni lni-lock"></i> 
									</button>
								</div>
							</div>
							
							<div class="col-12 col-lg-5">
								<label for="migration_status" class="form-label">Migration Status</label>
								<select class="form-select" id="migration_status"  name="migration_status" required  >
									<option value="" disabled selected>Please Select</option>
									<option value="EMPLOYMENT AUTHORIZATION" {% if obamacare.client.migration_status == "EMPLOYMENT AUTHORIZATION" %}selected{% endif %} >Employment Authorization</option>
									<option value="NOTICE OF ACTION" {% if obamacare.client.migration_status == "NOTICE OF ACTION" %}selected{% endif %} >Notice of Action (i-797)</option>
									<option value="REFUGEE" {% if obamacare.client.migration_status == "REFUGEE" %}selected{% endif %} >Refugee</option>
									<option value="ASYLUM" {% if obamacare.client.migration_status == "ASYLUM" %}selected{% endif %} >Asylum</option>
									<option value="TPS" {% if obamacare.client.migration_status == "TPS" %}selected{% endif %} >Temporary Protection Status (TPS)</option>
									<option value="DOMESTIC VIOLENCE" {% if obamacare.client.migration_status == "DOMESTIC VIOLENCE" %}selected{% endif %} >Domestic Violence</option>
									<option value="PERMANENT RESIDENT" {% if obamacare.client.migration_status == "PERMANENT RESIDENT" %}selected{% endif %} >Permanent Resident (Green Card)</option>
									<option value="CONDITIONAL RESIDENT" {% if obamacare.client.migration_status == "CONDITIONAL RESIDENT" %}selected{% endif %} >Conditional Resident</option>
									<option value="PAROLE" {% if obamacare.client.migration_status == "PAROLE" %}selected{% endif %} >Parole</option>
									<option value="US CITIZEN" {% if obamacare.client.migration_status == "US CITIZEN" %}selected{% endif %} >US Citizen (Driver's License)</option>
									<option value="STUDENT VISA" {% if obamacare.client.migration_status == "STUDENT VISA" %}selected{% endif %} >Student Visa (I-20)</option>
									<option value="CURRENTLY IN PROCESS" {% if obamacare.client.migration_status == "CURRENTLY IN PROCESS" %}selected{% endif %} >Currently In Process (this means the client received an i-797)</option>
								</select>
							</div>
							<div class="col-12 col-lg-2">
								<label for="apply" class="form-label">Apply</label>
								<select class="form-select" id="apply"  name="apply" required>
									<option value="" disabled selected>Please Select</option>
									<option value = True {% if obamacare.client.apply == True %}selected{% endif %} >SI</option>
									<option value = False {% if obamacare.client.apply == False %}selected{% endif %} >NO</option>
								</select>
							</div>
														
							<hr>

							<div class="d-flex align-items-center justify-content-between">
								<h4>Dependents</h4>
								<!-- Botón para abrir el modal -->
								<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addDependentModal">
									Add
								</button>
							</div>

							{% if not dependents %}
								<hr>
							{% endif %}	
														
						{% for dependent in dependents %}
	
							<div class="col-12 col-lg-5">
								<label class="form-label">Name of Dependent #{{ forloop.counter }}</label>
								<input type="hidden" name="dependentId_{{ dependent.id }}" value="{{ dependent.id }}">
								<input type="text" class="form-control" name="nameDependent_{{ dependent.id }}" value="{{ dependent.name }}" required >
							</div>
							<div class="col-12 col-lg-2">
								<label class="form-label">Apply</label>
								<select class="form-select" name="applyDependent_{{ dependent.id }}" required>
									<option value="" disabled selected>Please Select</option>
									<option value="YES" {% if dependent.apply == "YES" %}selected{% endif %}>YES</option>
									<option value="NO" {% if dependent.apply == "NO" %}selected{% endif %}>NO</option>
								</select>
							</div>
							<div class="col-12 col-lg-2">
								<label class="form-label">Sex</label>
								<select class="form-select" name="sexDependent_{{ dependent.id }}" required>
									<option value="" disabled selected>Please Select</option>
									<option value="M" {% if dependent.sex == "M" %}selected{% endif %}>MALE</option>
									<option value="F" {% if dependent.sex == "F" %}selected{% endif %}>FEMALE</option>
								</select>
							</div>
							<div class="col-12 col-lg-3">
								
								<label class="form-label">Policy Number</label>
								<input type="text" class="form-control" id="policyNumber"  name="policyNumberDependent_{{ dependent.id }}"  value="{{ dependent.policyNumber|default_if_none:'' }}" >
							</div>
							<div class="col-12 col-lg-3">
								<label for="kinship" class="form-label">Relationship</label>
								<select class="form-select" id="kinship" name="kinship_{{ dependent.id }}" aria-label="Default select example">
									<option value="" disabled selected>Please Select</option>
									<option value="DAD" {% if dependent.kinship == 'DAD' %}selected{% endif %}>DAD</option>
									<option value="MOM" {% if dependent.kinship == 'MOM' %}selected{% endif %}>MOM</option>
									<option value="SON" {% if dependent.kinship == 'SON' %}selected{% endif %}>SON</option>
									<option value="GRANDPARENT" {% if dependent.kinship == 'GRANDPARENT' %}selected{% endif %}>GRANDPARENT</option>
									<option value="GRANDMOTHER" {% if dependent.kinship == 'GRANDMOTHER' %}selected{% endif %}>GRANDMOTHER</option>
									<option value="COUPLE" {% if dependent.kinship == 'COUPLE' %}selected{% endif %}>COUPLE</option>
									<option value="UNKNOWN" {% if dependent.kinship == 'UNKNOWN' %}selected{% endif %}>UNKNOWN</option>
								</select>
							</div>
							<div class="col-12 col-lg-3">
								<label class="form-label">Date Birth</label>
								<input type="text" class="form-control" id="dateBirthDependent"  name="dateBirthDependent_{{ dependent.id }}"  value="{{ dependent.date_birth|date:'m/d/Y' }}" >
							</div>
							<div class="col-12 col-lg-6">
								<label class="form-label">Migration Status</label>
								<select class="form-select" name="migrationStatusDependent_{{ dependent.id }}" required >		
									<option value="" disabled selected>Please Select</option>
									<option value="EMPLOYMENT AUTHORIZATION" {% if dependent.migration_status == "EMPLOYMENT AUTHORIZATION" %}selected{% endif %} >Employment Authorization</option>
									<option value="NOTICE OF ACTION" {% if dependent.migration_status == "NOTICE OF ACTION" %}selected{% endif %} >Notice of Action (i-797)</option>
									<option value="REFUGEE" {% if dependent.migration_status == "REFUGEE" %}selected{% endif %} >Refugee</option>
									<option value="ASYLUM" {% if dependent.migration_status == "ASYLUM" %}selected{% endif %} >Asylum</option>
									<option value="TPS" {% if dependent.migration_status == "TPS" %}selected{% endif %} >Temporary Protection Status (TPS)</option>
									<option value="DOMESTIC VIOLENCE" {% if dependent.migration_status == "DOMESTIC VIOLENCE" %}selected{% endif %} >Domestic Violence</option>
									<option value="PERMANENT RESIDENT" {% if dependent.migration_status == "PERMANENT RESIDENT" %}selected{% endif %} >Permanent Resident (Green Card)</option>
									<option value="CONDITIONAL RESIDENT" {% if dependent.migration_status  == "CONDITIONAL RESIDENT" %}selected{% endif %} >Conditional Resident</option>
									<option value="PAROLE" {% if  dependent.migration_status == "PAROLE" %}selected{% endif %} >Parole</option>
									<option value="US CITIZEN" {% if  dependent.migration_status == "US CITIZEN" %}selected{% endif %} >US Citizen (Driver's License)</option>
									<option value="STUDENT VISA" {% if  dependent.migration_status == "STUDENT VISA" %}selected{% endif %} >Student Visa (I-20)</option>
									<option value="CURRENTLY IN PROCESS" {% if  dependent.migration_status == "CURRENTLY IN PROCESS" %}selected{% endif %} >Currently In Process (this means the client received an i-797)</option>
									<option value="UNKNOWN" {% if dependent.migration_status  == "UNKNOWN" %}selected{% endif %} >UNKNOWN</option>
								</select>
							</div>

							{% if request.user.role != 'A' %}
								<div class="col-12 col-lg-3">
									<a class="btn btn-danger" href="{% url 'toggleDependentsObama' dependent.id obamacare.id way %}"> Delete Dependent #{{ forloop.counter }}</a>	
								</div>
							{% endif %}
							
						<hr>
						{% endfor %}

						<H4>Plan</H4>
							<div class="col-12 col-lg-6">
								<label for="agent_usa_obamacare" class="form-label font-weight-bold">Agente USA</label>
								{% if request.user.company != obamacare.company %}
									<input readonly type="text" class="form-control" value="{{ obamacare.agent_usa }}" >
								{% else %}
									<select class="form-select" id="agent_usa_obamacare"  aria-label="Default select example" name="agent_usa_obamacare">
										<option value="no_valid">Please Select</option>
										{% for agentUsa in agentUsa %}
											<option {% if obamacare.agent_usa == agentUsa.name %}selected{% endif %}  value="{{agentUsa.name}}">{{agentUsa.name}}</option>
										{% endfor %}
									</select>
								{% endif %}
							</div>
							<div class="col-12 col-lg-2">
								<label for="taxes" class="form-label">Taxes</label>
								<input type="number" class="form-control" id="taxes" name="taxes" value="{{ obamacare.taxes }}" required >
							</div>
							<div class="col-12 col-lg-4">
								<label for="carrierObama" class="form-label">Carrier</label>
								<select class="form-select" id="carrierObama"  name="carrierObama" required  >
									<option value="" disabled selected>Please Select</option>
									<option value="AETNA" {% if obamacare.carrier == "AETNA" %}selected{% endif %} >AETNA</option>
									<option value="AMBETTER" {% if obamacare.carrier == "AMBETTER" %}selected{% endif %} >AMBETTER</option>
									<option value="ANTHEM" {% if obamacare.carrier == "ANTHEM" %}selected{% endif %} >ANTHEM</option>
									<option value="AVMED" {% if obamacare.carrier == "AVMED" %}selected{% endif %} >AVMED</option>
									<option value="BLUE CROSS" {% if obamacare.carrier == "BLUE CROSS" %}selected{% endif %} >BLUE CROSS</option>
									<option value="BRIGHT" {% if obamacare.carrier == "BRIGHT" %}selected{% endif %} >BRIGHT</option>
									<option value="CARE SOURCE" {% if obamacare.carrier == "CARE SOURCE" %}selected{% endif %} >CARE SOURCE</option>
									<option value="CIGNA" {% if obamacare.carrier == "CIGNA" %}selected{% endif %} >CIGNA</option>
									<option value="FLORIDA BLUE" {% if obamacare.carrier == "FLORIDA BLUE" %}selected{% endif %} >FLORIDA BLUE</option>
									<option value="FRIDAY" {% if obamacare.carrier == "FRIDAY" %}selected{% endif %} >FRIDAY</option>
									<option value="MEDICA" {% if obamacare.carrier == "MEDICA" %}selected{% endif %} >MEDICA</option>
									<option value="MOLINA" {% if obamacare.carrier == "MOLINA" %}selected{% endif %} >MOLINA</option>
									<option value="OSCAR" {% if obamacare.carrier == "OSCAR" %}selected{% endif %} >OSCAR</option>
									<option value="UNITED" {% if obamacare.carrier == "UNITED" %}selected{% endif %} >UNITED</option>
									<option value="CHRISTUS HEALTH" {% if obamacare.carrier == "CHRISTUS HEALTH" %}selected{% endif %} >CHRISTUS HEALTH</option>
									<option value="US HEALTH AND LIFE" {% if obamacare.carrier == "US HEALTH AND LIFE" %}selected{% endif %} >US HEALTH AND LIFE</option>
									<option value="MODA" {% if obamacare.carrier == "MODA" %}selected{% endif %} >MODA</option>
									<option value="PROVIDENCE" {% if obamacare.carrier == "PROVIDENCE" %}selected{% endif %} >PROVIDENCE</option>
									<option value="AMERIHEALTH CARITAS" {% if obamacare.carrier == "AMERIHEALTH CARITAS" %}selected{% endif %} >AMERIHEALTH CARITAS</option>
									<option value="HEALTH FRIST" {% if obamacare.carrier == "HEALTH FRIST" %}selected{% endif %} >HEALTH FRIST</option>
									<option value="WELLPOINT" {% if obamacare.carrier == "WELLPOINT" %}selected{% endif %} >WELLPOINT</option>
								</select>
							</div>
							<div class="col-12 col-lg-2">
								<label for="work" class="form-label font-weight-bold">Work</label>
								<select class="form-select" id="work" aria-label="Default select example"  name="work" required  >
									<option value="" disabled selected>Please Select</option>
									<option value="W2" {% if obamacare.work == "W2" %}selected{% endif %} >W2</option>
									<option value="1099"{% if obamacare.work == "1099"%}selected{% endif %} >1099</option> 
								</select>
							</div>
							<div class="col-12 col-lg-2">
								<label for="subsidy" class="form-label">Subsidy</label>
								<input type="number" step="0.00" class="form-control" id="subsidy" name="subsidy" value="{{ obamacare.subsidy }}" >
							</div>
							<div class="col-12 col-lg-2">
								<label for="ffm" class="form-label">FFM</label>
								<input type="number" class="form-control" id="ffm" name="ffm" value="{{obamacare.ffm}}" >
							</div>
							<div class="col-12 col-lg-2">
								<label for="required_bearing" class="form-label">Bearing</label>
								<select class="form-select" id="required_bearing" aria-label="Default select example"  name="required_bearing"   >
									<option value="" disabled selected>Please Select</option>
									<option value=1 {% if obamacare.required_bearing == 1 %}selected{% endif %}>YES</option>
									<option value=0 {% if obamacare.required_bearing == 0 %}selected{% endif %}>NO</option> 
								</select>
							</div>                    
							<div class="col-12 col-lg-2">
								<label for="date_bearing" class="form-label">Bearing Date</label>
								<input type="text" class="form-control" name="date_bearing" id="date_bearing" value="{{obamacare.date_bearing|date:'m/d/Y'}}" >
							</div>
							<div class="col-12 col-lg-2">
								<label for="doc_income" class="form-label">Income Doc</label>
								<select class="form-select" id="doc_income"  name="doc_income" required  >
									<option value ="" disabled selected>Please Select</option>
									<option value = True {% if obamacare.doc_income == True %}selected{% endif %} >YES</option>
									<option value = False {% if obamacare.doc_income == False %}selected{% endif %} >NO</option>
								</select>
							</div>
							<div class="col-12 col-lg-2">
								<label for="doc_migration" class="form-label">Inmigration Doc</label>
								<select class="form-select" id="doc_migration"  name="doc_migration" required  >
									<option value="" disabled selected>Please Select</option>
									<option value = True {% if obamacare.doc_migration == True %}selected{% endif %} >YES</option>
									<option value = False {% if obamacare.doc_migration == False %}selected{% endif %} >NO</option>
								</select>
							</div>						
							<div class="col-12 col-lg-4">
								<label for="planName" class="form-label">Plan Name</label>
								<input type="text" class="form-control" id="planName" name="planName" value="{{ obamacare.plan_name }}" required  >
							</div>
							<div class="col-12 col-lg-3">
								<label for="premium" class="form-label">Premium</label>
								<input type="number" step="0.01" class="form-control" id="premium" name="premium" value="{{ obamacare.premium }}" required >
							</div>
							<div class="col-12 col-lg-3">
								<label for="policyNumber" class="form-label">Policy Number</label>
								<input type="text" class="form-control" id="policyNumber" name="policyNumber" value="{{ obamacare.policyNumber|default_if_none:'' }}" >
							</div>
							<div class="col-12 col-lg-3">
								<label for="profiling" class="form-label">Enrolled by</label>
								<select required class="form-select" id="profiling" name="profiling">
									<option value="" disabled {% if not obamacare.profiling %}selected{% endif %}>Please Select</option>
									<option value="NO" {% if obamacare.profiling == "NO" %}selected{% endif %}>NO</option>

									{# Lista normal de usuarios inactivos #}
									{% for user in userInactive %}
										{% with user.first_name|add:" "|add:user.last_name as full_name %}
											{% if obamacare.profiling == full_name %}
												<option value="{{ full_name }}" selected>{{ full_name }}</option>
											{% endif %}
										{% endwith %}
									{% endfor %}

									{# Lista normal de usuarios activos #}
									{% for user in usersActive %}
										{% with user.first_name|add:" "|add:user.last_name as full_name %}
											<option value="{{ full_name }}" {% if obamacare.profiling == full_name %}selected{% endif %}>{{ full_name }}</option>
										{% endwith %}
									{% endfor %}

								</select>

							</div>
							<div class="col-12 col-lg-3">
								<label for="statusObama" class="form-label">Status</label>
								<select required class="form-select" id="statusObama"  name="statusObama" required >
									<option value="" disabled selected>Please Select</option>					
									{% for  list_drow in list_drow %}
										<option value="{{list_drow.profiling_obama}}" {% if obamacare.status == list_drow.profiling_obama %}selected{% endif %} >{{list_drow.profiling_obama}}</option>                      
									{% endfor %}
								</select>
							</div>
							{% if request.user.role != 'A' %}
							<div class="col-12 col-lg-3">
								<label for="usernameCarrier" class="form-label">Username Carrier</label>
								<input type="text" hidden name="usernameCarrierID" id="usernameCarrierID" value="{{userCarrier.id}}" >
								<input type="text" {% if userCarrier.username_carrier %} readonly {% endif %} class="form-control" name="usernameCarrier" id="usernameCarrier" value="{{userCarrier.username_carrier}}" >
							</div>
							<div class="col-12 col-lg-3">
								<label for="passwordCarrier" class="form-label">Password Carrier</label>
								<input type="text" class="form-control" {% if userCarrier.password_carrier %} readonly {% endif %} name="passwordCarrier" id="passwordCarrier" value="{{userCarrier.password_carrier}}" >
							</div>   
							<div class="col-12 col-lg-3">
								<label for="letters" class="form-label">Health market letters</label>
								<input type="text" hidden name="letterCardID" id="letterCardID" value="{{letterCard.id}}">
								{% if letterCard.letters %}
									<input type="text" class="form-control" readonly name="letters" id="letters" value="YES">
								{% else %}
									<select class="form-select" id="letters"  name="letters" required  >
										<option value="" disabled selected>Please Select</option>
										<option value = "True" {% if letterCard.letters %}selected{% endif %} >YES</option>
										<option value = "False" {% if not letterCard.letters %}selected{% endif %} >NO</option>
									</select>
								{% endif %}
							</div>   
							<div class="col-12 col-lg-3">
								<label for="card" class="form-label">Health Market Cards</label>
								{% if letterCard.card %}
									<input type="text" class="form-control" readonly name="card" id="card" value="YES">
								{% else %}
									<select class="form-select" id="card"  name="card" required  >
										<option value="" disabled selected>Please Select</option>
										<option value = "True" {% if letterCard.card  %}selected{% endif %} >YES</option>
										<option value = "False" {% if not letterCard.card %}selected{% endif %} >NO</option>
									</select>
								{% endif %}
								
							</div>   
							{% endif %}
							<div class="col-12 col-lg-3">
								<label for="date_effective_coverage" class="form-label">Date Effective Coverage</label>
								<input type="text" class="form-control" name="date_effective_coverage" id="date_effective_coverage" value="{{obamacare.date_effective_coverage|date:'m/d/Y'}}" >
							</div>
							<div class="col-12 col-lg-3">
								<label for="date_effective_coverage_end" class="form-label">Date Effective Coverage End</label>
								<input type="text" class="form-control" name="date_effective_coverage_end" id="date_effective_coverage_end" value="{{obamacare.date_effective_coverage_end|date:'m/d/Y'}}" >
							</div>   	       
							<div class="col-12 col-lg-6">
								<label for="observationObama" class="form-label">Observation</label>
								<textarea class="form-control" id="observationObama" name="observationObama" rows="8"  style="resize: none">{{ obamacare.observation }}</textarea>
							</div>
							<div class="col-12 col-lg-6">
								<label for="observationObama" class="form-label">Observation Agent</label>
								<textarea class="form-control" id="observationObama" name="observationObama" disabled rows="8"  style="resize: none">{{ obsObamaText }}</textarea>
							</div>
							{% if request.user.role == 'A' %}
							<div class="col-12 col-lg-6" id="obs_agent">
								<label for="obs_agent" class="form-label">OBS. AGENT</label>
								<input type="text" class="form-control" id="obs_agent" name="obs_agent"  >
							</div> 
							{% endif %}
							<hr>					            
							<div class="col-md-12">
								<div class="card border-0 shadow-sm">
									<div class="card-body p-4">
										<!-- Botones principales de acción -->
										<div class="d-flex flex-wrap gap-3 mb-4 pb-3 border-bottom">
											
											{% if request.user.role == 'C' or request.user.role == 'SUPP' %}
												<button type="button" id="openSubmitModal" class="btn btn-primary btn-lg px-5 py-2 shadow-sm">
													<i class="fas fa-save me-2"></i>
													<span class="fw-semibold">Submit</span>
												</button>
											{% else %}
												<button type="submit" name="action" value="save_obamacare" id="enviar" class="btn btn-primary btn-lg px-5 py-2 shadow-sm">
													<i class="fas fa-save me-2"></i>
													<span class="fw-semibold">Submit</span>
												</button> 
											{% endif %}											

											<button type="submit" name="action" id="enviar2" value="save_observation_agent" class="btn btn-success btn-lg px-5 py-2 shadow-sm" style="display: none;">
												<i class="fas fa-paper-plane me-2"></i>
												<span class="fw-semibold">Submits</span>
											</button>
											
											<!-- Botón Back -->
											{% if way == 1 %}
												{% if obamacare.created_at > fechaLimite %}
													<a href="{% url 'clientObamacare' %}" class="btn btn-outline-dark px-4 py-2 shadow-sm">
														<i class="fas fa-arrow-left me-2"></i>
														<span class="fw-semibold">Back</span>
													</a>
												{% else %}	
													<a href="{% url 'clientObamacarePass' %}" class="btn btn-outline-dark px-4 py-2 shadow-sm">
														<i class="fas fa-arrow-left me-2"></i>
														<span class="fw-semibold">Back</span>
													</a>								
												{% endif %}
											{% elif way == 2 %}
												<a href="{% url 'clientAccionRequired' %}" class="btn btn-outline-dark px-4 py-2 shadow-sm">
													<i class="fas fa-arrow-left me-2"></i>
													<span class="fw-semibold">Back</span>
												</a>
											{% endif %}
										</div>

										<!-- Sección de acciones rápidas -->
										<div class="row g-3">
											<!-- Documentos -->
											<div class="col-lg-4 col-md-6">
												<div class="bg-light-info bg-opacity-10 p-3 rounded-3 border border-info border-opacity-25">
													<h6 class="text-info mb-2 fw-bold">
														<i class="fas fa-folder-open me-2"></i>Documents
													</h6>
													<div class="d-grid gap-2">
														<a class="btn btn-outline-info btn-sm hover-lift" data-bs-toggle="modal" data-bs-target="#verConsent">
															<i class="fas fa-file-contract me-2"></i>Consent
														</a>
														<a class="btn btn-outline-info btn-sm hover-lift" data-bs-toggle="modal" data-bs-target="#verIncomeLetter">
															<i class="fas fa-file-invoice-dollar me-2"></i>Income Letter
														</a>
														<a class="btn btn-outline-info btn-sm hover-lift" data-bs-toggle="modal" data-bs-target="#verDocument">
															<i class="fas fa-file-alt me-2"></i>Document
														</a>
													</div>
												</div>
											</div>

											<!-- Gestión -->
											<div class="col-lg-4 col-md-6">
												<div class="bg-light-warning bg-opacity-10 p-3 rounded-3 border border-warning border-opacity-25">
													<h6 class="text-warning mb-2 fw-bold">
														<i class="fas fa-cogs me-2"></i>Management
													</h6>
													<div class="d-grid gap-2">
														<a class="btn btn-outline-warning btn-sm hover-lift" data-bs-toggle="modal" data-bs-target="#verAppointment">
															<i class="fas fa-calendar-check me-2"></i>Appointment
														</a>
														<a class="btn btn-outline-warning btn-sm hover-lift" data-bs-toggle="modal" data-bs-target="#verComplaint">
															<i class="fas fa-exclamation-triangle me-2"></i>Complaint
														</a>
													</div>
												</div>
											</div>

											{% if request.user.role == 'S' or request.user.is_superadmin or request.user.is_staff %}
											<!-- Cambios -->
											<div class="col-lg-4 col-md-6">
												<div class="bg-light-secondary bg-opacity-10 p-3 rounded-3 border border-secondary border-opacity-25">
													<h6 class="text-secondary mb-2 fw-bold">
														<i class="fas fa-edit me-2"></i>Changes
													</h6>
													<div class="d-grid gap-2">
														<a class="btn btn-outline-secondary btn-sm hover-lift" data-bs-toggle="modal" data-bs-target="#changeDate">
															<i class="fas fa-calendar-alt me-2"></i>Change Date
														</a>
														<a class="btn btn-outline-secondary btn-sm hover-lift" data-bs-toggle="modal" data-bs-target="#changeAgent">
															<i class="fas fa-user-edit me-2"></i>Change Agent
														</a>
													</div>
												</div>
											</div>
											{% endif %}
										</div>
									</div>
								</div>
							</div>
						{% csrf_token %}	
					</form>
					
					<hr>

					<div id="password-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
						<div style=" padding: 20px; max-width: 400px; margin: 100px auto; border-radius: 8px; text-align: center;">
							<h3>Ingresa la clave</h3>
							<input type="password" id="password-input" class="form-control" placeholder="Clave" style="margin: 10px 0; width: 100%;">
							<button id="submit-password" class="btn btn-primary">Enviar</button>
							<button id="cancel-password" class="btn btn-secondary">Cancelar</button>
						</div>
					</div>				
					
					<h5>Customer Departament:</h5>
					<div class="col-12 col-lg-12">

						<div class="row row-cols-auto g-3">

							<!-- Botones para abrir los modales -->
							<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#modalDocument">
								Documents
							</button>
							{% if request.user.role != 'A' %}
								<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#modalSelector">
									Observation
								</button>
								{% if request.user|has_module:"SMS" %}
									<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#modalAppointment">
										Appointment
									</button>
								{% endif %}
								<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#modalPayments">
									Payments
								</button>
								{% if request.user|has_module:"SMS" %}
									<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#modalPaymentsDate">
										Date Payment
									</button>
								{% endif %}
								<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#modalComplaint">
									Complaint
								</button>
								{% if request.user|has_module:"SMS" %}
									<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#modalSMS">
										SMS Temp
									</button>
								{% endif %}
							{% endif %}
							<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#AgentTicketAssignment">
								Ticket
							</button>
							<!-- Yarelys -->
							{% if request.user.is_staff or request.user.is_superuser or request.user.id == 18 %}
							<button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#modalEmailComplaint">
								Email Complaint
							</button>
							{% endif %}
							
							<button type="button" class="btn btn-secondary me-2" data-bs-toggle="modal" data-bs-target="#modalVerTexto">
								See Observations
							</button>
							{% if accionRequired %}
								<button type="button" class="btn btn-danger me-2" data-bs-toggle="modal" data-bs-target="#modalAccionRequired">
									See Accion Required
								</button>
							{% endif %}

							{% if renovation %}
								<p class="text-success fw-bold">It has already been renovated.</p>
							{% else %}
								{% if obamacare.created_at < fechaLimite or obamacare.type_sale != 'R' %}
									<!-- Botón para abrir el modal -->
									<a class="btn btn-success px-4" data-bs-toggle="modal" data-bs-target="#renovationModal">Renew</a>										
								{% endif %}		
							{% endif %}

						</div>

						<!-- Modal de selección inicial -->
						<div class="modal fade" id="modalSelector" tabindex="-1" aria-labelledby="modalSelectorLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="modalSelectorLabel">Select action</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body text-center">
										<h6 class="mb-4">What action do you wish to take?</h6>
										<div class="d-grid gap-3">
											<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalIngresarTexto" data-bs-dismiss="modal">
												Enter Observation
											</button>
											<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#modalActionrequired" data-bs-dismiss="modal">
												Enter Action Required
											</button>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para enviar el Email del Complaint -->
						<div class="modal modal-lg fade" id="modalEmailComplaint" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
							<div class="modal-dialog" role="document">
								<div class="modal-content">
									<form id="emailComplaintForm" method="POST">
										<div class="modal-header">
											<h5 class="modal-title" id="modalTitleId">
												Email Complaint
											</h5>
											<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
										</div>
										<div class="modal-body row">
											{% for complaint in complaints %}
												<div class="mb-3">
													<p></p>
												</div>
											{% endfor %}

											<div class="mb-3 col-10">
												<label for="firstConsent" class="form-label">First Consent</label>
												<select class="form-select" name="firstConsent" id="firstConsent" required>
													<option selected>Select one</option>
													{% for consents in consent %}
													<option value="{{ consents.id }}" data-url="{{ consents.pdf.url }}">Consent #{{ forloop.counter }} {{ consents.created_at|date:"Y-m-d H:i:s" }}</option>
													{% endfor %}
												</select>
											</div>
											<div class="col-2 pt-4">
												<a target="_blank" id='viewFirstConsent' href="">View Consent</a>
											</div>
											<div class="mb-3 col-10">
												<label for="lastConsent" class="form-label">Last Consent</label>
												<select class="form-select" name="lastConsent" id="lastConsent" required>
													<option selected>Select one</option>
													{% for consents in consent %}
													<option value="{{ consents.id }}" data-url="{{ consents.pdf.url }}">Consent #{{ forloop.counter }} {{ consents.created_at|date:"Y-m-d H:i:s" }}</option>
													{% endfor %}
												</select>
											</div>
											<div class="col-2 pt-4">
												<a target="_blank" id='viewLastConsent' href="">View Consent</a>
											</div>
											<div class="mb-3 col-10">
												<label for="complaint" class="form-label">Complaint</label>
												<select class="form-select" name="complaint" id="complaint" required>
													<option selected>Select one</option>
													{% for item in complaint %}
													<option value="{{ item.id }}" data-url="{{ item.pdf.url }}">Complaint #{{ forloop.counter }} {{ item.created_at|date:"Y-m-d H:i:s" }}</option>
													{% endfor %}
												</select>
											</div>
											<div class="col-2 pt-4">
												<a target="_blank" id='viewComplaint' href="">View Complaint</a>
											</div>
											<div class="col-6 mb-3">
												<label for="nameUnscrupulousAgent" class="form-label">Name of unscrupulous agent</label>
												<input type="text" class="form-control" name="nameUnscrupulousAgent" id="nameUnscrupulousAgent" required/>
											</div>
											<div class="col-6 mb-3">
												<label for="npnUnscrupulousAgent" class="form-label">NPN of unscrupulous agent</label>
												<input type="text" class="form-control" name="npnUnscrupulousAgent" id="npnUnscrupulousAgent" required/>
											</div>
										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
												Close
											</button>
											{% csrf_token %}
											<button type="submit" class="btn btn-primary">Send Email</button>
										</div>
									</form>
								</div>
							</div>
						</div>
						
				
						<!-- Modal para ingresar texto -->
						<div class="modal fade" id="modalIngresarTexto" tabindex="-1" aria-labelledby="modalIngresarTextoLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="modalIngresarTextoLabel">Enter Observation</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="formIngresarTexto" action="{% url 'saveCustomerObservationACA' %}" method="POST">
											{% csrf_token %}
											<input type="hidden" name="obamacare_id" value="{{ obamacare.id }}">
											<input type="hidden" name="way" value="{{way}}">
											<div class="mb-3">
												<label for="textoIngresado" class="form-label">Text:</label>
												<textarea class="form-control" id="textoIngresado" name="textoIngresado" rows="4" required></textarea>
											</div>
											<div class="mb-3">
												<label for="observaciones" class="form-label">Typification:</label>
												<select class="form-select"  name="observaciones[]" id="observaciones" multiple required>
													<option value="1095-A">1095-A</option>
													<option value="AUDITED">Audited</option>
													<option value="ACTIVE">Active</option>
													<option value="CANCEL">Cancel</option>
													<option value="PLAN CHANGE">Plan Change</option>
													<option value="AGENT CHANGE">Agent Change</option>
													<option value="T/C CHANGE">T/C Change</option>
													<option value="CARRIER">Carrier</option>
													<option value="APPOINTMENTS">Appointments</option>
													<option value="SATISFIED CUSTOMER">Satisfied Customer</option>
													<option value="CORRECTION">Correction</option>
													<option value="PAYMENT ERROR CORRECTION">Payment Error Correction</option>
													<option value="PORTAL CREATION">Portal/Member ID/Brochure Creation</option>
													<option value="DEMOGRAPHIC DATA">Demographic Data</option>
													<option value="DOCUMENTS IN SHERPA">Documents in Sherpa</option>
													<option value="DOCUMENTS RECEIVED">Documents Received</option>
													<option value="ID CARD SEND">ID Card Send</option>
													<option value="DENTIST LISTING">Dentist listing</option>
													<option value="OPTOMETER LISTING">Optometer Listing</option>
													<option value="PLAN EXPLANATION">Plan Explanation</option>
													<option value="OUT OF SERVICE">Out of Service</option>
													<option value="HEALTHSAFE ID">HEALTHSAFE ID</option>
													<option value="ID MEMBER">ID Member</option>
													<option value="ID SUPERVISOR">ID Supervisor</option>
													<option value="CARRIER SUP CALL">Carrier Supervisor Call</option>
													<option value="EFFECTIVE MANAGEMENT">Effective Management</option>
													<option value="WELCOME MESSAGE">Welcome Message</option>
													<option value="FOLLOW-UP CALL">Follow-up call</option>
													<option value="INFORMATIVE MESSAGE">Informative Message</option>
													<option value="MARKET CALL">Market Call</option>
													<option value="NO ANSWER">No Answer</option>
													<option value="OTHER PARTY">Other Party</option>
													<option value="DENTAL PAYMENT UHC">Dental Payment via UHC</option>
													<option value="VISION PAYMENT UHC">Vision Payment via UHC</option>
													<option value="CARRIER ACA PORTAL">Carrier ACA Portal</option>
													<option value="CARD RECEIPT">Card Receipt</option>
													<option value="RECOVERED">Recovered</option>
													<option value="REFERAL">Referal</option>
													<option value="ROLLED OVER">Rolled Over</option>
													<option value="PREMIUM PAYMENT">Premium Payment</option>
													<option value="PCP">PCP</option>
													<option value="REQUEST DOCUMENTS">Request Documents</option>
													<option value="SUPPLEMENTARY">Supplemental</option>
													<option value="TRANSFER">Transfer</option>
													<option value="UHC ID READY">UHC ID Ready</option>
													<option value="CALL BACK">Call Back</option>
													<option value="INFORMATIVE CALLS ACA SUP">Informative Calls ACA/Supplementaries</option>
													<option value="HANGS UP">Hangs Up</option>
												</select>
											</div>
											<div class="mb-3">
												<label for="textoIngresado" class="form-label">Typification the Call:</label>
												<select class="form-select"  name="typeCall" >
													<option></option>
													<option value="INBOUND" >Inbound </option>
													<option value="OUTBOUND" >Outbound </option>
													<option value="WHATSAPP" >WhatsApp</option>
													<option value="TXT MESSAGE" >Txt Message</option>
													<option value="SHERPA" >Sherpa</option>
												</select>
											</div>
											<div class="d-flex justify-content-between">
												<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#modalSelector" data-bs-dismiss="modal">
													Back
												</button>
												<button type="submit" class="btn btn-primary">Saved</button>
											</div>
										</form>
										
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar ticket de agent a customer -->
						<div class="modal fade" id="AgentTicketAssignment" tabindex="-1" aria-labelledby="AgentTicketAssignmentLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="AgentTicketAssignmentLabel">Enter Ticket</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="formIngresarTexto" action="{% url 'agentTicketAssignment' %}" method="POST">
											{% csrf_token %}
											<input type="hidden" name="obamacare_id" value="{{ obamacare.id }}">
											<input type="hidden" name="way" value="{{way}}">
											<div class="mb-3">
												<label for="textoIngresado" class="form-label">Text:</label>
												<textarea class="form-control" id="textoIngresado" name="textoIngresado" rows="4" required style="resize: none;"></textarea>
											</div>
											<div class="mb-3">
												<label for="agent_customer" class="form-label">Agent to assign:</label>
												<select class="form-select"  name="agent_customer" id="agent_customer" >
													<option value="no_valid" disabled selected>Please Select</option>
													{% for user  in users %}												
														<option value="{{user.id}}">{{user.first_name}} {{user.last_name}}</option>
													{% endfor %}
												</select>
											</div>
											<div class="d-flex justify-content-between">
												<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-dismiss="modal">
													Back
												</button>
												<button type="submit" class="btn btn-primary">Saved</button>
											</div>
										</form>
										
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar ticket de agent a customer -->
						<div class="modal fade" id="modalComplaint" tabindex="-1" aria-labelledby="modalComplaintLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="AgentTicketAssignmentLabel">Enter Information</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="formIngresarTexto" action="{% url 'preComplaint'  %}" method="POST">
											{% csrf_token %}
											<input type="hidden" name="obamacare_id" value="{{ obamacare.id }}">
											<div class="mb-3">
												<label for="nameAgent" class="form-label">Name Agent:</label>
												<input type="text" id="nameAgent" class="form-control" name="nameAgent" required>
											</div>
											<div class="mb-3">
												<label for="npnAgent" class="form-label">NPN (SI APLICA):</label>
												<input type="number" id="npnAgent" class="form-control" name="npnAgent" >
											</div>
											<div class="d-flex justify-content-between">
												<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-dismiss="modal">
													Back
												</button>
												<button type="submit" class="btn btn-primary">Saved</button>
											</div>
										</form>
										
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para SMS TEMPLATE -->
						<div class="modal fade" id="modalSMS" tabindex="-1" aria-labelledby="modalSMSLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="SMS"> Select a template</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="smsForm" action="{% url 'smstemplate'  %}"  enctype="multipart/form-data" method="POST">
											{% csrf_token %}
											<label for="nameAgent" class="form-label">Select Option:</label>
											<input type="hidden" name="idClient" value="{{obamacare.client.id}}">
											<input type="hidden" name="way" value="{{way}}">
											<div class="mb-3">
												<select class="form-select"  name="sms" id="sms" required>
													<option value="" selected disabled ></OPtion>
													{% for item in smsTemplateAll %}
														<option value="{{item.id}}">{{item.identification}}</option>
													{% endfor %}
												</select>
											</div>
											<div  id="welcome-fields" class="mb-3" style="display: none;">
												<input type="file" class="filepond" name="filepond">									
											</div>
											<div class="d-flex justify-content-between">
												<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-dismiss="modal"> Back </button>
												<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#modalViewSMS" data-bs-dismiss="modal"> View SMS </button>
												<button type="submit" class="btn btn-primary">SEND</button>
											</div>
										</form>
										
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ver template sms send -->
						<div class="modal fade" id="modalViewSMS" tabindex="-1" aria-labelledby="modalViewSMSLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="modalIngresarTextoLabel">View SMS</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">

										{% for item in smsTemplate %}
											<div class="mb-1">
												<label class="form-label"> <strong>SMS # </strong> {{forloop.counter}}: {{item.contentTemplate.identification}} <strong>Date: </strong> {{item.created_at|date:'m/d/Y'}} </label>
											</div>
										{% endfor %}
										
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar citas medicas -->
						<div class="modal fade" id="modalAppointment" tabindex="-1" aria-labelledby="modalAppointmentLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="modalAppointmentLabel">Enter Appointment</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="saveAppointment" action="{% url 'saveAppointment' obamacare.id %}" method="POST">
											{% csrf_token %}
											<input type="hidden" name="way" value="{{way}}">
											<div class="mb-3">
												<label for="appointment" class="form-label">Text:</label>
												<textarea class="form-control" id="appointment" name="appointment" rows="4" required></textarea>
											</div>
											<div class="mb-3">
												<label for="dateAppointment" class="form-label">Date of Appointment:</label>
												<input type="text" class="form-control" name="dateAppointment" id="dateAppointment" required >
											</div>
											<div class="mb-3">
												<label for="timeAppointment" class="form-label">Appointment Time:</label>
												<input type="time" class="form-control" name="timeAppointment" id="timeAppointment" required >
											</div>
											<button type="submit" class="btn btn-primary">Send</button>
										</form>
										
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar fecha de recordatorio de pago -->
						<div class="modal fade" id="modalPaymentsDate" tabindex="-1" aria-labelledby="modalPaymentsDateLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="modalAppointmentLabel">Enter Collection Message Date</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="paymentDateObama" action="{% url 'paymentDateObama' obamacare.id %}" method="POST">
											{% csrf_token %}
											<div class="mb-3">
												<label for="paymentDate" class="form-label">Collection reminder date:</label>
												<input type="text" class="form-control" name="paymentDate" id="paymentDate" required >
												{% if paymentDateObama %}
													<label for="">📌 Collection date: <strong>{{paymentDateObama.payment_date}}</strong> </label>
												{% endif %}
											</div>
											<div class="d-flex justify-content-between">
												<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#modalSelector" data-bs-dismiss="modal">
													Back
												</button>
												<button type="submit" class="btn btn-primary">Saved</button>
											</div>
										</form>
										
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar Document -->
						<div class="modal fade" id="modalDocument" tabindex="-1" aria-labelledby="modalDocumentLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="modalIngresarTextoLabel">Upload Document </h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<div class="card">
											<div class="card-body">
												<form  method="POST" enctype="multipart/form-data">
													{% csrf_token %}
													<input type="file" id="pdfUploader" name="documents" multiple>
													<div id="fileNamesContainer"></div>												
													<button id="loadDocument" class="btn" data-upload-url="{% url 'saveDocumentClient' obamacare.id way %}" > <i class="fa-solid fa-floppy-disk"></i></button>
												</form>
											</div>
										</div>

										<div id="loader" class="loader-overlay">
											<div class="loader"></div>
											<p>Uploading files, please wait...</p>
										</div>
										
									</div>
								</div>
							</div>
						</div>
				
						<!-- Modal para ver las observaciones -->
						<div class="modal fade" id="modalVerTexto" tabindex="-1" aria-labelledby="modalVerTextoLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="modalVerTextoLabel">Saved Remarks</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										{% if obsCustomer %}
											<ul class="list-group">
												{% for observation in obsCustomer %}
													<li class="list-group-item">
														📌 <strong>{{ observation.agent.first_name }} {{ observation.agent.last_name }}:</strong> {{ observation.content }} <strong>Date:</strong> {{ observation.created_at }}
													</li>
												{% endfor %}
											</ul>
										{% else %}
											<p>There are no saved remarks.</p>
										{% endif %}
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ver las Accion Required -->
						<div class="modal fade" id="modalAccionRequired" tabindex="-1" aria-labelledby="modalAccionRequired" aria-hidden="true">
							<div class="modal-dialog modal-lg">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="modalAccionRequired">Actions required</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>

									<div class="modal-body">
										<div class="table-responsive" >
											<table id="actionRequiredTable" class="table table-hover" >
												<thead>
													<tr>
														<th scope="col">Action</th>
														<th scope="col">State</th>
													</tr>
												</thead>
												<tbody>
													{% for accionRequired in accionRequired %}
														{%if  not accionRequired.date_completed%}
															<tr class="">
																<td scope="row">{{accionRequired.clave}}</td>
																<td>
																	<label class="switch">
																		<input id="checkbox_{{ accionRequired.id }}" value="{{accionRequired.id}}" type="checkbox" onchange="toogleActionRequired(this)" >
																		<span class="slider round"></span>
																	</label>
																</td>
															</tr>
														{% endif %}
														{% if request.user.role == 'Admin' or request.user.role == 'S' %}
															{%if  accionRequired.date_completed%}
																<tr class="">
																	<td scope="row">{{accionRequired.clave}}</td>
																	<td>
																		<label class="switch">
																			<input disabled id="checkbox_{{ accionRequired.id }}" value="{{accionRequired.id}}" type="checkbox" checked >
																			<span class="slider round"></span>
																		</label>
																	</td>
																</tr>													
															{% endif %}
														{% endif %}
													{% endfor %}
												</tbody>
											</table>
										</div>
									</div>


								</div>
							</div>
						</div>
			
						<!-- Modal para ver los consent -->
						<div class="modal fade" id="verConsent" tabindex="-1" aria-labelledby="verConsentLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="verConsentLabel">Saved Consent</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										{% if consent %}
											<ul class="list-group">
												{% for consents in consent %}											
													<li class="list-group-item">
														<strong>Consent #{{forloop.counter}}:</strong> <a href="{{ consents.pdf.url }} " target="_blank" >View  <i class="lni lni-display"></i></a> 
													</li>
												{% endfor %}
											</ul>
										{% else %}
											<p>No consent.</p>
										{% endif %}
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ver las consent -->
						<div class="modal fade" id="verComplaint" tabindex="-1" aria-labelledby="verComplaintLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="verConsentLabel">View Complaint</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										{% if complaint %}
											<ul class="list-group">
												{% for item in complaint %}											
													<li class="list-group-item">
														<strong>Complaint #{{forloop.counter}}:</strong> <a href="{{ item.pdf.url }} " target="_blank" >View  <i class="lni lni-display"></i></a> 
													</li>
												{% endfor %}
											</ul>
										{% else %}
											<p>No Complaint.</p>
										{% endif %}
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para cambiar la fecha -->
						<div class="modal fade" id="changeDate" tabindex="-1" aria-labelledby="vchangeDateLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<form id="changeDateForm" action="{% url 'changePlanDate' obamacare.id %}" method="POST">
										<div class="modal-header">
											<h5 class="modal-title" id="changeDateLabel">Change Date</h5>
											<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
										</div>
										<div class="modal-body">
											{% csrf_token %}
											<div class="mb-3">
												<label for="newDate" class="form-label">New Date:</label>
												<input type="text" class="form-control flatpickr-date" name="newDate" id="newDate" value="{{ obamacare.created_at|date:'m/d/Y' }}" required>
											</div>
											<div class="mb-3">
												<label for="reason" class="form-label">Reason:</label>
												<textarea class="form-control" name="reason" id="reason" rows="3" required></textarea>
											</div>
											
											<input type="hidden" name="type_plan" id="type_plan" value="obamacare">
											<button type="submit" class="btn btn-primary">Change</button>
										</div>
									</form>
								</div>
							</div>
						</div>

						<!-- Modal para cambiar el agente de registro -->
						<div class="modal fade" id="changeAgent" tabindex="-1" aria-labelledby="vchangeAgentLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<form id="changeAgentForm" action="{% url 'changePlanAgent' obamacare.id %}" method="POST">
										<div class="modal-header">
											<h5 class="modal-title" id="changeDateLabel">Change Agent</h5>
											<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
										</div>
										<div class="modal-body">
											{% csrf_token %}
											<div class="mb-3">
												<label for="newAgent" class="form-label">New Agent:</label>
												<select class="form-select" name="newAgent" id="newAgent">
													{% for agent in agents %}
														<option {% if obamacare.agent_id == agent.id %} selected {% endif %} value="{{ agent.id }}">{{ agent.first_name }} {{ agent.last_name }}</option>
													{% endfor %}
												</select>
											</div>
											<div class="mb-3">
												<label for="reason" class="form-label">Reason:</label>
												<textarea class="form-control" name="reason" id="reason" rows="3" required></textarea>
											</div>
											<input type="hidden" name="type_plan" id="type_plan" value="obamacare">
											<button type="submit" class="btn btn-primary">Change</button>
										</div>
									</form>
								</div>
							</div>
						</div>

						<!-- Modal para ver las Income -->
						<div class="modal fade" id="verIncomeLetter" tabindex="-1" aria-labelledby="verIncomeLetter" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="verIncomeLetter">Saved Income Letter</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										{% if income %}
											<ul class="list-group">
												{% for incomes in income %}											
													<li class="list-group-item">
														<strong>Letter Income #{{forloop.counter}}:</strong> <a href="{{ incomes.pdf.url }}" target="_blank" >View  <i class="lni lni-display"></i></a> 
													</li>
												{% endfor %}
												<hr>
												{% if incomeffm %}
													{% for item in incomeffm %}
														<li class="list-group-item">
															<strong>Letter Income FFM #{{forloop.counter}}:</strong> <a href="{{ item.pdf.url }}" target="_blank" >View  <i class="lni lni-display"></i></a> 
														</li>
													{% endfor %}
												{% endif %}
											</ul>
											{% if not incomeffm %}
												{% if obamacare.ffm %}										
													<hr>
													<div class="d-flex order-actions">
														<!-- Botón principal del dropdown -->
														<button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
															L.I
														</button>
														<!-- Lista del dropdown -->
														<ul class="dropdown-menu">
															<li>
																<form action="{% url 'ILFFM' obamacare.id %}" method="get" target="_blank">
																	<input type="hidden" name="lenguaje" value="en">
																	<button type="submit" class="dropdown-item"> English</button>
																</form>
															</li>
															<li>
																<form action="{% url 'ILFFM' obamacare.id %}" method="get" target="_blank">                                         <input type="hidden" name="lenguaje" value="en">
																	<input type="hidden" name="lenguaje" value="es">
																	<button type="submit" class="dropdown-item"> Spanish</button>
																</form>
															</li>
														</ul>
													</div>
												{% endif %}
											{% endif %}
										{% else %}
											<p>No Income.</p>
										{% endif %}
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ver las Document -->
						<div class="modal fade" id="verDocument" tabindex="-1" aria-labelledby="verDocument" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="verDocument">Saved documents</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										{% if document or documentObama%}
											<ul class="list-group">

												{% if document %} <h5>Documents Consent</h5> {% endif %}

												{% for documents in document %}													
													<li class="list-group-item">
														<strong>Documents Consent #{{forloop.counter}}:</strong> <a href="{{ documents.file.url }}" target="_blank" >View  <i class="lni lni-display"></i></a> 
													</li>
												{% endfor %}

												{% if document and documentObama %} <hr> {% endif %}

												{% if documentObama %} <h5>Documents Upload CRM</h5> {% endif %}

												{% for documents in documentObama %}															
													<li class="list-group-item">
														<strong>{{documents.name}}:</strong> <a href="{{ documents.file.url }}" target="_blank" >View  <i class="lni lni-display"></i></a> 
													</li>
												{% endfor %}

											</ul>
										{% else %}
											<p>No Documents.</p>
										{% endif %}
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ver las Appointment -->
						<div class="modal fade" id="verAppointment" tabindex="-1" aria-labelledby="verAppointment" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="verAppointment">Saved quotes</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										{% if apppointment %}
											<ul class="list-group">
												{% for apppointments in apppointment %}
													<li class="list-group-item">
														📌 Agent <strong>{{ apppointments.agent_create.first_name }} {{ apppointments.agent_create.last_name }}</strong> created an appointment for client <strong> {{obamacare.client.first_name}} {{obamacare.client.last_name}}  </strong> 
														for the following condition: <strong>{{ apppointments.appointment}}</strong>, on the date: <strong>{{ apppointments.dateAppointment|date:'m/d/Y'}}</strong> and at the time: <strong>{{ apppointments.timeAppointment}} </strong>
													</li>
												{% endfor %}
											</ul>
										{% else %}
											<p>There are no saved remarks.</p>
										{% endif %}
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ver los pagos -->
						<div class="modal fade" id="modalPayments" tabindex="-1" aria-labelledby="modalPayments" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="verAppointment">Enter Payments</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<div class="table-responsive" >
											<table id="paymentsTable" class="table table-striped table-hover table-bordered shadow-sm centerAllExceptFirst">
												<thead>
													<tr>
														<th>Month</th>
														{% if companyInsurance != 'LAPEIRA & ASSOCIATES LLC' and user.role in 'Admin,Supervisor'%}
														<th>Oneil</th>
														<th>Lapeira</th>
														{% else %}
														<th>Lapeira</th>
														{% endif %}
														<th>Carrier</th>
														<th>Sherpa</th>
													</tr>
												</thead>
												<tbody>
													{% for month, values in paymentsSummary.items %}
													<tr>
														<td>{{ month }}</td>
														{% if companyInsurance != 'LAPEIRA & ASSOCIATES LLC' and user.role in 'Admin,Supervisor' %}
														<td>
															{% if values.oneil == 0 %}❌
															{% elif values.oneil > 0 %}✅
															{% elif values.oneil < 0 %} <img src="{% static 'assets/images/icons/minus.png' %}" width="25px">
															{% else %}{{ values.oneil }}
															{% endif %}
														</td>
														<td>
															{% if values.lapeira == 0 %}❌
															{% elif values.lapeira > 0 %}✅
															{% elif values.lapeira < 0 %} <img src="{% static 'assets/images/icons/minus.png' %}" width="25px">
															{% endif %}
														</td>
														{% else %}
														<td>
															{% if values.lapeira == 0 %}❌
															{% elif values.lapeira > 0 %}✅
															{% elif values.lapeira < 0 %} <img src="{% static 'assets/images/icons/minus.png' %}" width="25px">
															{% endif %}
														</td>
														{% endif %}
														<td>
															{% if values.carrier%}✅
															{% else %}❌
															{% endif %}
														</td>
														<td>
															{% if values.sherpa%}✅
															{% else %}❌
															{% endif %}
														</td>
													</tr>
													{% endfor %}
												</tbody>
											</table>
										</div>
										
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-primery" data-bs-toggle="modal" data-bs-target="#modalChildEnterPaymentsOneil">
											Enter Payments Oneil
										</button>
										<button type="button" class="btn btn-primery" data-bs-toggle="modal" data-bs-target="#modalChildEnterPaymentsCarrier">
											Enter Payments Carrier
										</button>
										<button type="button" class="btn btn-primery" data-bs-toggle="modal" data-bs-target="#modalChildEnterPaymentsSherpa">
											Enter Payments Sherpa
										</button>
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar payments Oneil -->
						<div class="modal fade" id="modalChildEnterPaymentsOneil" tabindex="-1" aria-labelledby="modalChildEnterPaymentsOneil" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Enter Payments Oneil</h5>
										<button type="button" class="btn-primary" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="formPaymentsOneil">
											<div class="mb-3">
												<label for="" class="form-label">Month</label>
												<input type="month" class="form-control" name="coverageMonth" required>
											</div>
											<div class="mb-3">
												<label for="" class="form-label">PayDay</label>
												<input type="date" class="form-control" name="payday" required>
											</div>
											{% if companyInsurance != 'LAPEIRA & ASSOCIATES LLC' and user.role in 'Admin,Supervisor' %}	
											<div class="mb-3">
												<label for="" class="form-label">Insurance Company</label>
												<select class="form-select" name="insuranceCompany" required>
													<option value='' disabled selected>Select one</option>
													<option value="{{companyInsurance}}">{{companyInsurance}}</option>
													<option value="LAPEIRA & ASSOCIATES LLC">LAPEIRA & ASSOCIATES LLC</option>
												</select>
											</div>
											{% endif %}
											<div class="mb-3">
												<label for="" class="form-label">Payable</label>
												<select class="form-select" name="payable" required>
													<option value='' disabled selected>Select one</option>
													<option value="1">Paid</option>
													<option value="-1">Not Pay</option>
												</select>
											</div>
											<button type="submit" class="btn btn-primary">Save</button>
										</form>
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar payments Carrier -->
						<div class="modal fade" id="modalChildEnterPaymentsCarrier" tabindex="-1" aria-labelledby="modalChildEnterPaymentsCarrier" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Enter Payments Carrier</h5>
										<button type="button" class="btn-primary" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="formPaymentsCarrier">
											<div class="mb-3">
												<label for="" class="form-label">Month</label>
												<input type="month" class="form-control" name="coverageMonth" required>
											</div>
											<div class="mb-3">
												<label for="" class="form-label">Status</label>
												<select class="form-select" name="status" required>
													<option value='' disabled selected>Select one</option>
													<option value="Active">Active</option>
													<option value="Inactive">Inactive</option>
												</select>
											</div>
											<button type="submit" class="btn btn-primary">Save</button>
										</form>
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar payments Sherpa -->
						<div class="modal fade" id="modalChildEnterPaymentsSherpa" tabindex="-1" aria-labelledby="modalChildEnterPaymentsSherpa" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Enter Payments Sherpa</h5>
										<button type="button" class="btn-primary" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="formPaymentsSherpa">
											<div class="mb-3">
												<label for="" class="form-label">Month</label>
												<input type="month" class="form-control" name="coverageMonth" required>
											</div>
											<div class="mb-3">
												<label for="" class="form-label">Status</label>
												<select class="form-select" name="status" required>
													<option value='' disabled selected>Select one</option>
													<option value="Active">Active</option>
													<option value="Inactive">Inactive</option>
												</select>
											</div>
											<button type="submit" class="btn btn-primary">Save</button>
										</form>
									</div>
								</div>
							</div>
						</div>

						<!-- Modal para ingresar las accion required -->
						<div class="modal fade" id="modalActionrequired" tabindex="-1" aria-labelledby="modalActionrequired" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="Actionrequired">Enter Action required</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="formIngresarTexto" action="{% url 'saveAccionRequired'  %}" method="POST">
											{% csrf_token %}
											<input type="hidden" name="plan_id" value="{{ obamacare.id }}">
											<div class="mb-3">
												<label for="description" class="form-label">Typification the Call:</label>
												<select class="form-select"  id="description" name="description" >
													<option></option>
													{% for list_drow in description %}
														<option value="{{ list_drow.description }}">{{ list_drow.description|title }}</option>
													{% endfor %}
												</select>
											</div>
											<div class="d-flex justify-content-between">
												<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#modalSelector" data-bs-dismiss="modal">
													Back
												</button>
												<button type="submit" class="btn btn-primary">Saved</button>
											</div>
										</form>
										
									</div>
								</div>
							</div>
						</div>

						<!-- Modal de Renovación -->
						<div class="modal fade" id="renovationModal" tabindex="-1" aria-labelledby="renovationModalLabel" aria-hidden="true">
							<div class="modal-dialog modal-xl modal-dialog-scrollable">
								<div class="modal-content">
									
									<div class="modal-header bg-success text-white">
										<h5 class="modal-title" id="renovationModalLabel">
											<i class="bi bi-arrow-repeat me-2"></i>Renovación de Cliente
										</h5>
										<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									
									<div class="modal-body">
										<!-- Formulario de Renovación -->
										<form class="row g-3 needs-validation" method="POST" action="{% url 'saveRenovation' %}" id="renovationForm">
											{% csrf_token %}
											
											<!-- Campo oculto para identificar que es una renovación -->
											<input type="hidden" name="originalClientId" value="{{obamacare.client.id}}">
											<input type="hidden" name="passObamacareId" value="{{obamacare.id}}">
											
											<h4 class="text-success border-bottom pb-2">Cliente</h4>
											
											<div class="col-12 col-lg-4">
												<label for="renovation_first_name" class="form-label">First Name</label>
												<input type="text" class="form-control" name="first_name" id="renovation_first_name" placeholder="First Name" value="{{obamacare.client.first_name}}" required>
											</div>
											<div class="col-12 col-lg-4">
												<label for="renovation_last_name" class="form-label">Last Name</label>
												<input type="text" class="form-control" name="last_name" id="renovation_last_name" placeholder="Last Name" value="{{obamacare.client.last_name}}" required>
											</div>
											<div class="col-12 col-lg-4">
												<label for="renovation_phone_number" class="form-label">Phone Number</label>
												<input type="number" class="form-control" name="phone_number" id="renovation_phone_number" placeholder="Phone Number" value="{{obamacare.client.phone_number}}" required>
											</div>
											
											<div class="col-12 col-lg-3">
												<label for="renovation_email" class="form-label">E-mail Address</label>
												<input type="email" class="form-control" name="email" id="renovation_email" placeholder="Enter Email Address" value="{{obamacare.client.email}}" required>
											</div>
											<div class="col-12 col-lg-3">
												<label for="renovation_address" class="form-label">Address</label>
												<input type="text" class="form-control" name="address" id="renovation_address" placeholder="Address" value="{{obamacare.client.address}}" required>
											</div>
											<div class="col-12 col-lg-2">
												<label for="renovation_zipcode" class="form-label">Zip Code</label>
												<input type="text" maxlength="5" oninput="this.value = this.value.replace(/[^0-9]/g, '')" class="form-control" name="zipcode" id="renovation_zipcode" value="{{obamacare.client.zipcode}}" required>
											</div>
											<div class="col-12 col-lg-2">
												<label for="renovation_city" class="form-label">City</label>
												<input type="text" class="form-control" name="city" id="renovation_city" value="{{obamacare.client.city}}" required>
											</div>
											<div class="col-12 col-lg-2">
												<label for="renovation_state" class="form-label font-weight-bold">State</label>
												<input type="text" class="form-control" name="state" id="renovation_state" value="{{obamacare.client.state}}" required>
											</div>
											
											<div class="col-12 col-lg-3">
												<label for="renovation_county" class="form-label">County</label>
												<input type="text" class="form-control" name="county" id="renovation_county" value="{{obamacare.client.county}}" required>
											</div>
											<div class="col-12 col-lg-2">
												<label for="renovation_sex" class="form-label">Sex</label>
												<select class="form-select" name="sex" id="renovation_sex" required>
													<option value="" disabled>Please Select</option>
													<option value="M" {% if obamacare.client.sex == "M" %}selected{% endif %}>MALE</option>
													<option value="F" {% if obamacare.client.sex == "F" %}selected{% endif %}>FEMALE</option>
												</select>
											</div>
											<div class="col-12 col-lg-2">
												<label for="renovation_old" class="form-label">Age</label>
												<input type="number" class="form-control" name="old" id="renovation_old" placeholder="Age" value="{{old}}" readonly>
											</div>

											<div class="col-12 col-lg-3">
												<label for="renovation_date_birth" class="form-label">Date Birth</label>
												<input type="text" class="form-control flatpickr-date" name="date_birth" id="renovation_date_birth" value="{{ obamacare.client.date_birth|date:'m/d/Y' }}" required>
											</div>

											<div class="col-12 col-lg-2">
												<label for="renovation_apply" class="form-label">Apply</label>
												<select class="form-select" id="renovation_apply" name="apply" required>
													<option value="" disabled>Please Select</option>
													<option value="True" {% if obamacare.client.apply %}selected{% endif %}>SI</option>
													<option value="False" {% if not obamacare.client.apply %}selected{% endif %}>NO</option>
												</select>
											</div>
											
											<div class="col-12 col-lg-6">
												<label for="renovation_migration_status" class="form-label">Migration Status</label>
												<select class="form-select" id="renovation_migration_status" name="migration_status" required>
													<option value="" disabled>Please Select</option>
													<option value="EMPLOYMENT AUTHORIZATION" {% if obamacare.client.migration_status == "EMPLOYMENT AUTHORIZATION" %}selected{% endif %}>Employment Authorization</option>
													<option value="NOTICE OF ACTION" {% if obamacare.client.migration_status == "NOTICE OF ACTION" %}selected{% endif %}>Notice of Action (i-797)</option>
													<option value="REFUGEE" {% if obamacare.client.migration_status == "REFUGEE" %}selected{% endif %}>Refugee</option>
													<option value="ASYLUM" {% if obamacare.client.migration_status == "ASYLUM" %}selected{% endif %}>Asylum</option>
													<option value="TPS" {% if obamacare.client.migration_status == "TPS" %}selected{% endif %}>Temporary Protection Status (TPS)</option>
													<option value="DOMESTIC VIOLENCE" {% if obamacare.client.migration_status == "DOMESTIC VIOLENCE" %}selected{% endif %}>Domestic Violence</option>
													<option value="PERMANENT RESIDENT" {% if obamacare.client.migration_status == "PERMANENT RESIDENT" %}selected{% endif %}>Permanent Resident (Green Card)</option>
													<option value="CONDITIONAL RESIDENT" {% if obamacare.client.migration_status == "CONDITIONAL RESIDENT" %}selected{% endif %}>Conditional Resident</option>
													<option value="PAROLE" {% if obamacare.client.migration_status == "PAROLE" %}selected{% endif %}>Parole</option>
													<option value="US CITIZEN" {% if obamacare.client.migration_status == "US CITIZEN" %}selected{% endif %}>US Citizen (Driver's License)</option>
													<option value="STUDENT VISA" {% if obamacare.client.migration_status == "STUDENT VISA" %}selected{% endif %}>Student Visa (I-20)</option>
													<option value="CURRENTLY IN PROCESS" {% if obamacare.client.migration_status == "CURRENTLY IN PROCESS" %}selected{% endif %}>Currently In Process</option>
												</select>
											</div>
											
											<!-- Sección de Dependientes (si existen) -->
											<div id="renovationDependents">
												<!-- Aquí se cargarán los dependientes dinámicamente -->
											</div>

											<hr>
											<h4 class="text-success border-bottom pb-2">Plan de Renovación</h4>
											
											<div class="col-12 col-lg-6">
												<label for="renovation_agent_usa_obamacare" class="form-label font-weight-bold">Agente USA Plan</label>
												<select class="form-select" id="renovation_agent_usa_obamacare" name="agent_usa_obamacare" required>
													<option value="">Please Select</option>
													{% for agentUsa in agentUsa %}
														<option {% if obamacare.agent_usa == agentUsa.name %}selected{% endif %} value="{{agentUsa.name}}">{{agentUsa.name}}</option>
													{% endfor %}
												</select>
											</div>
											
											<div class="col-12 col-lg-2">
												<label for="renovation_taxes" class="form-label">Taxes</label>
												<input type="number" class="form-control" id="renovation_taxes" name="taxes" value="{{ obamacare.taxes }}" required>
											</div>
											
											<div class="col-12 col-lg-4">
												<label for="renovation_carrier" class="form-label">Carrier</label>
												<select class="form-select" id="renovation_carrier" name="carrier" required>
													<option value="" disabled>Please Select</option>
													<option value="AETNA" {% if obamacare.carrier == "AETNA" %}selected{% endif %}>AETNA</option>
													<option value="AMBETTER" {% if obamacare.carrier == "AMBETTER" %}selected{% endif %}>AMBETTER</option>
													<option value="ANTHEM" {% if obamacare.carrier == "ANTHEM" %}selected{% endif %}>ANTHEM</option>
													<option value="AVMED" {% if obamacare.carrier == "AVMED" %}selected{% endif %}>AVMED</option>
													<option value="BLUE CROSS" {% if obamacare.carrier == "BLUE CROSS" %}selected{% endif %}>BLUE CROSS</option>
													<option value="BRIGHT" {% if obamacare.carrier == "BRIGHT" %}selected{% endif %}>BRIGHT</option>
													<option value="CARE SOURCE" {% if obamacare.carrier == "CARE SOURCE" %}selected{% endif %}>CARE SOURCE</option>
													<option value="CIGNA" {% if obamacare.carrier == "CIGNA" %}selected{% endif %}>CIGNA</option>
													<option value="FLORIDA BLUE" {% if obamacare.carrier == "FLORIDA BLUE" %}selected{% endif %}>FLORIDA BLUE</option>
													<option value="FRIDAY" {% if obamacare.carrier == "FRIDAY" %}selected{% endif %}>FRIDAY</option>
													<option value="MEDICA" {% if obamacare.carrier == "MEDICA" %}selected{% endif %}>MEDICA</option>
													<option value="MOLINA" {% if obamacare.carrier == "MOLINA" %}selected{% endif %}>MOLINA</option>
													<option value="OSCAR" {% if obamacare.carrier == "OSCAR" %}selected{% endif %}>OSCAR</option>
													<option value="UNITED" {% if obamacare.carrier == "UNITED" %}selected{% endif %}>UNITED</option>
													<option value="CHRISTUS HEALTH" {% if obamacare.carrier == "CHRISTUS HEALTH" %}selected{% endif %}>CHRISTUS HEALTH</option>
													<option value="US HEALTH AND LIFE" {% if obamacare.carrier == "US HEALTH AND LIFE" %}selected{% endif %}>US HEALTH AND LIFE</option>
													<option value="MODA" {% if obamacare.carrier == "MODA" %}selected{% endif %}>MODA</option>
													<option value="PROVIDENCE" {% if obamacare.carrier == "PROVIDENCE" %}selected{% endif %}>PROVIDENCE</option>
													<option value="AMERIHEALTH CARITAS" {% if obamacare.carrier == "AMERIHEALTH CARITAS" %}selected{% endif %}>AMERIHEALTH CARITAS</option>
													<option value="HEALTH FRIST" {% if obamacare.carrier == "HEALTH FRIST" %}selected{% endif %}>HEALTH FRIST</option>
													<option value="WELLPOINT" {% if obamacare.carrier == "WELLPOINT" %}selected{% endif %}>WELLPOINT</option>
												</select>
											</div>
											<div class="col-12 col-lg-2">
												<label for="renovation_work" class="form-label font-weight-bold">Work</label>
												<select class="form-select" id="renovation_work" name="work" required>
													<option value="" disabled>Please Select</option>
													<option value="W2" {% if obamacare.work == "W2" %}selected{% endif %}>W2</option>
													<option value="1099" {% if obamacare.work == "1099" %}selected{% endif %}>1099</option>
												</select>
											</div>
											
											<div class="col-12 col-lg-2">
												<label for="renovation_subsidy" class="form-label">Subsidy</label>
												<input type="number" step="0.01" class="form-control" id="renovation_subsidy" name="subsidy" value="{{ obamacare.subsidy }}">
											</div>
																							
											<div class="col-12 col-lg-2">
												<label for="renovation_doc_income" class="form-label">Income Doc</label>
												<select class="form-select" id="renovation_doc_income" name="doc_income" required>
													<option value="" disabled>Please Select</option>
													<option value="True" {% if obamacare.doc_income %}selected{% endif %}>YES</option>
													<option value="False" {% if not obamacare.doc_income %}selected{% endif %}>NO</option>
												</select>
											</div>
											
											<div class="col-12 col-lg-2">
												<label for="renovation_doc_migration" class="form-label">Immigration Doc</label>
												<select class="form-select" id="renovation_doc_migration" name="doc_migration" required>
													<option value="" disabled>Please Select</option>
													<option value="True" {% if obamacare.doc_migration %}selected{% endif %}>YES</option>
													<option value="False" {% if not obamacare.doc_migration %}selected{% endif %}>NO</option>
												</select>
											</div>
											
											<div class="col-12 col-lg-4">
												<label for="renovation_plan_name" class="form-label">Plan Name</label>
												<input type="text" class="form-control" id="renovation_plan_name" name="plan_name" value="{{ obamacare.plan_name }}" required>
											</div>
											
											<div class="col-12 col-lg-3">
												<label for="renovation_premium" class="form-label">Premium</label>
												<input type="number" step="0.01" class="form-control" id="renovation_premium" name="premium" value="{{ obamacare.premium }}" required>
											</div>												
											
											<div class="col-12">
												<label for="renovation_observation" class="form-label">Observation</label>
												<textarea class="form-control" id="renovation_observation" name="observation" rows="3" style="resize: none" placeholder="Observaciones para la renovación..."></textarea>
											</div>
											
										</form>
									</div>
									
									<div class="modal-footer bg-light">
										<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
											<i class="bi bi-x-circle me-2"></i>Cancel
										</button>
										<button type="submit" form="renovationForm" class="btn btn-success">
											<i class="bi bi-check-circle me-2"></i>Save Renewal
										</button>
									</div>

								</div>
							</div>
						</div>

						<!-- Modal Add dependents -->
						<div class="modal fade" id="addDependentModal"  tabindex="-1" aria-labelledby="addDependentModalLabel" aria-hidden="true">
							<div class="modal-dialog modal-lg">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="addDependentModalLabel">Add Dependent</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<!-- Formulario dentro del modal -->
										<form  action="{% url 'addDependObama' obamacare.id way %}" method="POST">
											<div class="row g-3">
												<div class="col-12 col-lg-6">
													<label class="form-label">Name of Dependent</label>
													<input type="text" class="form-control" name="nameDependent" required>
												</div>
												<div class="col-12 col-lg-6">
													<label class="form-label">Apply</label>
													<select class="form-select" name="applyDependent" required>
														<option disabled selected ></option>
														<option value="YES">YES</option>
														<option value="NO">NO</option>
													</select>
												</div>
												<div class="col-12 col-lg-6">
													<label class="form-label">Date Birth</label>
													<input type="text" class="form-control" name="dateBirthDependent" id="dateBirthDependent" required >
												</div>
												<div class="col-12 col-lg-6">
													<label class="form-label">Migration Status</label>
													<select class="form-select" name="migrationStatusDependent" required>															
														<option  disabled selected>Please Select</option>
														<option value="EMPLOYMENT AUTHORIZATION">Employment Authorization</option>
														<option value="NOTICE OF ACTION">Notice of Action (i-797)</option>
														<option value="REFUGEE">Refugee</option>
														<option value="ASYLUM">Asylum</option>
														<option value="TPS">Temporary Protection Status (TPS)</option>
														<option value="DOMESTIC VIOLENCE">Domestic Violence</option>
														<option value="PERMANENT RESIDENT">Permanent Resident (Green Card)</option>
														<option value="CONDITIONAL RESIDENT">Conditional Resident</option>
														<option value="PAROLE">Parole</option>
														<option value="US CITIZEN">US Citizen (Driver's License)</option>
														<option value="STUDENT VISA">Student Visa (I-20)</option>
														<option value="CURRENTLY IN PROCESS">Currently In Process (this means the client received an i-797)</option>	  
													</select>
												</div>
												<div class="col-12 col-lg-6">
													<label class="form-label">Sex</label>
													<select class="form-select" name="sexDependent" required>
														<option disabled selected ></option>
														<option value="M">MALE</option>
														<option value="F">FEMALE</option>
													</select>
												</div>
												<div class="col-12 col-lg-6">
													<label for="kinship" class="form-label">Relationship</label>
													<select class="form-select" id="kinship" name="kinship" aria-label="Default select example" required>
														<option disabled selected ></option>
														<option value="DAD">DAD</option>
														<option value="MOM">MOM</option>
														<option value="SON">SON</option>
														<option value="GRANDPARENT">GRANDPARENT</option>
														<option value="GRANDMOTHER">GRANDMOTHER</option>
														<option value="COUPLE">COUPLE</option>
														<option value="OTHER">OTHER</option>
													</select>
												</div>
												<div class="d-flex align-items-center gap-3" >
													<button type="submit" class="btn btn-primary">Save</button>
												</div>
												{% csrf_token %} 
											</div>								
										</form>
									</div>
								</div>
							</div>
						</div>

						<div id="missingDocuments" style="display: none;">
							{% if not letterCard.letters %} <p style="line-height: 0.6;">❌ <b>Letters</b></p> {% endif %}
							{% if not letterCard.card %} <p style="line-height: 0.6;">❌ <b>Card</b></p> {% endif %}
							{% if not userCarrier.username_carrier %} <p style="line-height: 0.6;">❌ <b>Username Carrier</b></p> {% endif %}
							{% if not obamacare.status == 'ACTIVE' %} <p style="line-height: 0.6;">❌ <b>Status</b></p> {% endif %}
							{% if not obamacare.doc_migration %} <p style="line-height: 0.6;">❌ <b>Migration Document</b></p> {% endif %}
							{% if not obamacare.doc_income %} <p style="line-height: 0.6;">❌ <b>Income Document</b></p> {% endif %}
							{% if obamacare.policyNumber == '' or obamacare.policyNumber == None or obamacare.policyNumber == 'None' %}
								<p style="line-height: 0.6;">❌ <b>Policy Number</b></p>
							{% endif %}
							{% if not apppointment %} <p style="line-height: 0.6;">❌ <b>Apppointment</b></p> {% endif %}
						</div>
						
					</div>	

				</div>			
			</div>
		</div>
	</div>

	<!-- Modal para escribir nota antes de enviar -->
	<div class="modal fade" id="submitModal" tabindex="-1" aria-labelledby="submitModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content rounded-3 shadow">

				<div class="modal-header">
					<h5 class="modal-title fw-semibold" id="submitModalLabel">Add note before saving</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
				</div>

				<div class="modal-body">
					<div class="mb-3">
						<h6 class="fw-semibold text-primary mb-2"> <i class="bx bx-error-circle me-1"></i> Issues detected:	</h6>

						<ul class="list-group list-group-flush small">
							{% if not letterCard.letters %}
								<li class="list-group-item py-1 ps-4"><i class="bx bx-mail-send text-warning me-2"></i> Letter</li>
							{% endif %}
							{% if not letterCard.card %}
								<li class="list-group-item py-1 ps-4"><i class="bx bx-id-card text-warning me-2"></i> Card</li>
							{% endif %}
							{% if not userCarrier.username_carrier %}
								<li class="list-group-item py-1 ps-4"><i class="bx bx-user-circle text-warning me-2"></i> Carrier user </li>
							{% endif %}
							{% if not obamacare.premium == '0.00'%}
								{% if not paymentDateObama %}
									<li class="list-group-item py-1 ps-4"><i class="bx bx-calendar text-warning me-2"></i> Fecha de pago</li>
								{% endif %}
							{% endif %}
							{% if obamacare.status != 'ACTIVE' %}
								<li class="list-group-item py-1 ps-4"><i class="bx bx-check-shield text-warning me-2"></i> Status</li>
							{% endif %}
							{% if not obamacare.doc_income %}
								<li class="list-group-item py-1 ps-4"><i class="bx bx-file text-warning me-2"></i> Documento de taxes</li>
							{% endif %}
							{% if not obamacare.doc_migration %}
								<li class="list-group-item py-1 ps-4"><i class="bx bx-globe text-warning me-2"></i> Documento de migración</li>
							{% endif %}
							{% if not obamacare.policyNumber %}
								<li class="list-group-item py-1 ps-4"><i class="bx bx-list-ol text-warning me-2"></i> Número de póliza</li>
							{% endif %}
							{% if not apppointment %}
								<li class="list-group-item py-1 ps-4"><i class="bx bx-calendar-event text-warning me-2"></i> Citas</li>
							{% endif %}
						</ul>
					</div>

					<div class="mt-3">
						<h6 class="fw-semibold text-secondary mb-2"> Did you take care of the pending issues? </h6>

						<p class="text-muted small mb-2">
							If you made changes, please briefly describe what adjustments you made to the client:
						</p>

						<textarea id="noteContent" class="form-control shadow-sm" rows="4" placeholder="Write a note..."></textarea>
					</div>

				</div>


				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" id="confirmSubmitBtn" class="btn btn-primary">Save and Send</button>
				</div>

			</div>
		</div>
	</div>

	{% if smsIsActive %}
		<!-- Chat UI -->
		<div {% if userPreference.darkMode %} class='dark-mode'{% endif %}>
			<button class="floating-chat-button flex-grow-1" onclick="toggleChat()">
				<i class="lni lni-comments-alt"></i>
				{% if chat.is_message_unread %}<span class="alert-count">{{ chat.unread_messages }}</span>{% endif %}
			</button>
			
			<div class="floating-chat-container" id="chatContainer">
				<div class="floating-chat-header">
					<span class="client-name">{{contact.name}} <br>{{contact.formatted_phone_number}}</span>
					<div class="chat-actions">
						{% if secretKey %}
						<button id="buttonSendSecretKey" class="tooltip-container"><span class="tooltip-text">Send Secret Key</span><i class="bx bx-key me-1"></i></button>
						{% else %}
						<button id="buttonCreateSecretKey" class="tooltip-container"><span class="tooltip-text">Create Secret Key</span><i class="bx bx-key me-1"></i></button>
						{% endif %}
					</div>
				</div>
				<div class="floating-chat-body" id="chat-content">
					{% if not messages %}
						<div class="d-flex justify-content-center align-items-center" id="buttonStartChat">
							<div class="dropdown">
								<button class="btn btn-primary dropdown-toggle custom-dropdown" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
									🌍 Select Language
								</button>
								<ul class="dropdown-menu animate-dropdown" aria-labelledby="languageDropdown">
									<li><a class="dropdown-item" href="#" onclick="setLanguage('english')">🇺🇸 English</a></li>
									<li><a class="dropdown-item" href="#" onclick="setLanguage('spanish')">🇪🇸 Español</a></li>
								</ul>
							</div>
						</div>
					{% else %}
						{% for message in messages %}
							{%if message.sender_type == 'Client'%}
								<div class="chat-content-leftside">
									<div class="d-flex">
										<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 24 24" fill="none" stroke="currentColor"
											stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user">
											<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
											<circle cx="12" cy="7" r="4"></circle>
										</svg>
										<div class="flex-grow-1 ms-2">
											<p class="mb-0 chat-time">{{obamacare.client.first_name}}, {{message.created_at|date:"g:i A"}}</p>
											{% if message.file %}
											<p class="chat-left-msg">
												<img class="img-responsive" src="{{ message.file.file.url }}" alt="">
											</p>
											{% else %}
											<p class="chat-left-msg" style="white-space: pre-wrap;">{{message.message_content}}</p>
											{% endif %}
										</div>
									</div>
								</div>
							{%elif message.sender_type == 'Agent'%}
								<div class="chat-content-rightside">
									<div class="d-flex ms-auto">
										<div class="flex-grow-1 me-2">
											<p class="mb-0 chat-time text-end">{{message.sender.username}}, {{ message.created_at|date:"m:H - d/m" }}</p>
											{% if message.file %}
											<p class="chat-left-msg">
												<img class="img-responsive" src="{{ message.file.file.url }}" alt="">
											</p>
											{% else %}
											<p class="chat-right-msg">{{message.message_content|linebreaksbr}}</p>
											{% endif %}
										</div>
									</div>
								</div>
							{% endif %}
						{% endfor %}
					{% endif %}
				</div>
				<div class="floating-chat-footer">
					<input {% if not contact.is_active %}disabled{% endif %} type="text" id="messageContent" placeholder="Type a message...">
					<button id="sendMessage">Send</button>
				</div>
			</div>
		</div>
	{% endif %}

{% endblock %}
{% block end_js %}
	<!-- Bootstrap JS -->
	<script src="{% static 'assets/js/bootstrap.bundle.min.js' %}"></script>
	<!--plugins-->
	<script src="{% static 'assets/js/jquery.min.js' %}"></script>
	<script src="{% static 'assets/plugins/simplebar/js/simplebar.min.js' %}"></script>
	<script src="{% static 'assets/plugins/metismenu/js/metisMenu.min.js' %}"></script>
	<script src="{% static 'assets/plugins/perfect-scrollbar/js/perfect-scrollbar.js' %}"></script>
	<script src="{% static 'assets/plugins/datatable/js/jquery.dataTables.min.js' %}"></script>
	<script src="{% static 'assets/plugins/datatable/js/dataTables.bootstrap5.min.js' %}"></script>

	<!-- Agregar Flatpickr -->
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

	<!-- Incluir JS de Choices.js -->
	<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

	<script src="{% static 'assets/plugins/bs-stepper/js/bs-stepper.min.js' %}"></script>
	<script src="{% static 'assets/plugins/bs-stepper/js/main.js' %}"></script>

	<!-- Incluir FilePond JS -->
    <script src="https://unpkg.com/filepond/dist/filepond.js"></script>
    
    <!-- Incluir plugins -->
    <script src="https://unpkg.com/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js"></script>
    <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
	<script src="{% static 'assets/js/validations/templatePhoto.js' %}"></script>

	<!--app JS-->
	<script src="{% static 'assets/js/app.js' %}"></script>
	<script src="{% static 'assets/js/validations/blockSocial.js' %}"></script>
	<script src="{% static 'assets/js/validations/validationZicode.js' %}"></script>
	<script src="{% static 'assets/js/validations/saveDocumentObama.js' %}" defer></script>	
	<script src="{% static 'assets/js/payments/fetchPayments.js' %}"></script>
	<script src="{% static 'assets/js/payments/paymentDateObama.js' %}"></script>
	<script src="{% static 'assets/js/validations/editObama.js' %}"></script>

	<link href="https://unpkg.com/filepond/dist/filepond.min.css" rel="stylesheet">
	<script src="https://unpkg.com/filepond/dist/filepond.min.js"></script>
	<script src="https://unpkg.com/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.min.js"></script>

	<script src="{% static 'assets/js/validations/saveDocumentObama.js' %}"></script>
	<script src="{% static 'assets/js/validations/duplicidadClient.js' %}"></script>

	<!-- Scripts SMS's -->
	<script>
		var obamacare_id = '{{obamacare.id}}'
		var company_id = '{{request.user.company.id}}'
		var username = '{{request.user.username}}'
		var contact_id = '{{contact.id}}'
		var chat_id = '{{ contact.phone_number }}'
		var chat_name = '{{ contact.name }}'
		var	is_message_unread = '{{chat.is_message_unread}}'.toLowerCase() === "true";
	</script>
	
	<script src="{% static 'assets/js/sms/scripts.js' %}"></script>

	<!-- Sweetalert para avisar cuando se envio el SMS template -->
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script src="{% static 'assets/js/modals/confirmationSMSAutomatic.js' %}"></script>

	<!-- JS para crear la peticion para cambiar fecha -->
	<script src="{% static 'assets/js/validations/changeDate.js' %}"></script>
	
	<!-- JS para modificar la url de los botones de los consents -->
	<script src="{% static 'assets/js/validations/emailComplaint.js' %}"></script>
	
	<script src="{% static 'assets/js/modals/modalRenovations.js' %}"></script>
	<script src="{% static "assets/js/modals/saveMonitoringObama.js" %}"></script>
	
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			const existingDependents = [
				{% for dependent in dependents %}
				{
					id: '{{ dependent.id }}',
					name: '{{ dependent.name }}',
					apply: '{{ dependent.apply }}',
					sex: '{{ dependent.sex }}',
					kinship: '{{ dependent.kinship }}',
					date_birth: '{{ dependent.date_birth|date:"m/d/Y" }}', // ← Cambiado aquí
					policy_number: '{{ dependent.policyNumber|default_if_none:"" }}',
					migration_status: '{{ dependent.migration_status }}'
				}{% if not forloop.last %},{% endif %}
				{% endfor %}
			];
			
			$('#renovationModal').on('shown.bs.modal', function() {
				setTimeout(() => {
					if (existingDependents.length > 0) {
						loadExistingDependents(existingDependents);
					}
				}, 100);
			});
		});
	</script>

	{% if temporalyURL %}
		<script>
async function copyCurrentURL() {
    let currentURL = '{{ temporalyURL|safe }}';

    const url = new URL(currentURL);
    const params = new URLSearchParams(url.search);
    const language = params.get('lenguaje');

    // Si no tiene el parámetro de lenguaje, preguntar
    if (!language) {
        const result = await Swal.fire({
            title: 'Select your language',
            text: 'Please choose a language before copying the link:',
            icon: 'question',
            showDenyButton: true,
            showCancelButton: true,
            confirmButtonText: 'English',
            denyButtonText: 'Español',
            cancelButtonText: 'Cancel',
            reverseButtons: true
        });

        if (result.isConfirmed) {
            params.set('lenguaje', 'en');
        } else if (result.isDenied) {
            params.set('lenguaje', 'es');
        } else {
            console.log('Usuario canceló');
            return; // Sale sin copiar
        }

        url.search = params.toString();
        currentURL = url.toString();
    }

    try {
        await navigator.clipboard.writeText(currentURL);

        const successMessage = document.querySelector('.success-message');
        const button = document.querySelector('.copy-button');
        const originalContent = button.innerHTML;

        const lang = new URLSearchParams(url.search).get('lenguaje') || 'es';
        const copiedText = lang === 'en' ? 'Copied!' : '¡Copiado!';

        if (successMessage) successMessage.style.display = 'block';
        button.innerHTML = `<i class="fas fa-check"></i> ${copiedText}`;

        setTimeout(() => {
            if (successMessage) successMessage.style.display = 'none';
            button.innerHTML = originalContent;
        }, 2000);

    } catch (err) {
        console.error('Error al copiar:', err);
        Swal.fire({
            icon: 'error',
            title: language === 'en' ? 'Error copying' : 'Error al copiar',
            text: language === 'en'
                ? 'Could not copy the link. Please try again.'
                : 'No se pudo copiar el link. Por favor, inténtalo de nuevo.'
        });
    }
}


		</script>
	{% endif %}
	
{% endblock %}