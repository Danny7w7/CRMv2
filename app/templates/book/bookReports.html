

{% extends "dashboard/index.html" %}
{% load static %}
{% block head %}
    <title>Books Reports</title>
	<!--plugins-->
	<link href="{% static "assets/plugins/simplebar/css/simplebar.css" %}" rel="stylesheet" />
	<link href="{% static "assets/plugins/perfect-scrollbar/css/perfect-scrollbar.css" %}" rel="stylesheet" />
	<link href="{% static "assets/plugins/metismenu/css/metisMenu.min.css" %}" rel="stylesheet" />
	<link href="{% static "assets/plugins/datatable/css/dataTables.bootstrap5.min.css" %}" rel="stylesheet" />
	<!-- loader-->
	<link href="{% static "assets/css/pace.min.css" %}" rel="stylesheet" />
	<script src="{% static "assets/js/pace.min.js" %}"></script>
	<!-- Bootstrap CSS -->
	<link href="{% static "assets/css/bootstrap.min.css" %}" rel="stylesheet">
	<link href="{% static "assets/css/bootstrap-extended.css" %}" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&amp;display=swap" rel="stylesheet">
	<link href="{% static "assets/css/app.css" %}" rel="stylesheet">
	<link href="{% static "assets/css/icons.css" %}" rel="stylesheet">
	<!-- Theme Style CSS -->
	<link rel="stylesheet" href="{% static "assets/css/dark-theme.css" %}" />
	<link rel="stylesheet" href="{% static "assets/css/semi-dark.css" %}" />
	<link rel="stylesheet" href="{% static "assets/css/header-colors.css" %}" />
{% endblock %}
{% block page_content %}
<h4 class="mb-0 text-uppercase">ðŸ“Š General book report</h4>
<hr/>

<div class="row row-cols-1 row-cols-md-1 row-cols-lg-2 row-cols-xl-2" >

    <div class="col">
		<div class="card mb-3">
            <div class="card-body">
                <div class="table-responsive" >
                    
                    <h5 class="mb-4">Total reading time per user</h5>
                    <table id="table1" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Total time (seconds)</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for readingUser in readingUser %}
                            <tr>
                                <td>{{ readingUser.user__username }}</td>
                                <td>{{ readingUser.total_time }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="2">No data available.</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    
                </div>
            </div>
        </div>
    </div>
        
    <div class="col">
	    <div class="card mb-3">
            <div class="card-body">
                <div class="table-responsive" >                    
                    <h5 class="mb-4">Average time per page</h5>
                    <table id="table2" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Book</th>
                                <th>Page</th>
                                <th>Average time (seconds)</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for readingPage in readingPage %}
                            <tr>
                                <td>{{ readingPage.book__title }}</td>
                                <td>{{ readingPage.page }}</td>
                                <td>{{ readingPage.avg_time }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="3">No data available.</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>                    
                </div>
            </div>
        </div>
    </div>

</div>

<div class="row row-cols-1 row-cols-md-1 row-cols-lg-2 row-cols-xl-2" >

    <div class="col">
		<div class="card mb-3">
            <div class="card-body">
                <div class="table-responsive">
                    <h5 class="mb-4">Most read books</h5>
                    <table id="table3" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Book</th>
                                <th>Total time (seconds)</th>
                                <th>Total readings</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for booksRead in booksRead %}
                            <tr>
                                <td>{{ booksRead.title }}</td>
                                <td>{{ booksRead.total_time }}</td>
                                <td>{{ booksRead.total_lecturas }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="3">No data available.</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
        
    <div class="col">
	    <div class="card mb-3">
            <div class="card-body">
                <div class="table-responsive" >                    
                    <h5 class="mb-4">Readings per day</h5>
                    <table id="table4" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Date (Y-M-D)</th>
                                <th>Total time (seconds)</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for readingDay in readingDay %}
                            <tr>
                                <td>{{ readingDay.date|date:"Y-m-d" }}</td>
                                <td>{{ readingDay.total_time }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="2">No data available.</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>                    
                </div>
            </div>
        </div>
    </div>

</div>

<div class="row row-cols-1 row-cols-md-1 row-cols-lg-2 row-cols-xl-2" >

    <div class="col">
		<div class="card mb-3">
            <div class="card-body">
                <div class="table-responsive">
                    <h5 class="mb-4">Readings per day and user</h5>
                    <table id="table5" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Date (Y-M-D)</th>
                                <th>User</th>
                                <th>Total time (seconds)</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for readingsDayUsers in readingsDayUsers %}
                            <tr>
                                <td>{{ readingsDayUsers.date|date:"Y-m-d" }}</td>
                                <td>{{ readingsDayUsers.user__username }}</td>
                                <td>{{ readingsDayUsers.total_time }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="3">No data available.</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
        
    <div class="col">
	    <div class="card mb-3">
            <div class="card-body">
                <div class="table-responsive" >                    
                    <h5 class="mb-4">Readings per day, user, and book</h5>
                    <table id="table6" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Date (Y-M-D)</th>
                                <th>User</th>
                                <th>Book</th>
                                <th>Total time (seconds)</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for readingsDayUserBook in readingsDayUserBook %}
                            <tr>
                                <td>{{ readingsDayUserBook.date|date:"Y-m-d" }}</td>
                                <td>{{ readingsDayUserBook.user__username }}</td>
                                <td>{{ readingsDayUserBook.book__title }}</td>
                                <td>{{ readingsDayUserBook.total_time }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="4">No data available.</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>                    
                </div>
            </div>
        </div>
    </div>

</div>

{% endblock %}
{% block end_js %}
	<!-- Bootstrap JS -->
	<script src="{% static "assets/js/bootstrap.bundle.min.js" %}"></script>
	<!--plugins-->
	<script src="{% static "assets/js/jquery.min.js" %}"></script>
	<script src="{% static "assets/plugins/simplebar/js/simplebar.min.js" %}"></script>
	<script src="{% static "assets/plugins/metismenu/js/metisMenu.min.js" %}"></script>
	<script src="{% static "assets/plugins/perfect-scrollbar/js/perfect-scrollbar.js" %}"></script>
	<script src="{% static "assets/plugins/datatable/js/jquery.dataTables.min.js" %}"></script>
	<script src="{% static "assets/plugins/datatable/js/dataTables.bootstrap5.min.js" %}"></script>
	<script>
        $(document).ready(function() {
            // Itera del 1 al 6 para inicializar cada tabla
            for (let i = 1; i <= 6; i++) {
                const tableId = '#table' + i; // Construye el ID de la tabla, por ejemplo, '#table1', '#table2', etc.
                const table = $(tableId).DataTable({
                    lengthChange: false,
                    buttons: ['excel', 'print']
                });
                // Mueve los botones al contenedor deseado
                table.buttons().container().appendTo(tableId + '_wrapper .col-md-6:eq(0)');
            }
        });
    </script>
	<!--app JS-->
	<script src="{% static "assets/js/app.js" %}"></script>
{% endblock %}