<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Reporte 6 Semanas</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            padding: 20px;
        }
        .chart-container {
            page-break-after: always;
            margin-bottom: 40px;
        }
        .chart-container:last-child {
            page-break-after: auto;
        }
    </style>
</head>
<body>
    <h1>Reporte de Ventas - Ãšltimas 6 Semanas</h1>

    {% for agente in summary %}
        <div class="chart-container">
            <h2>{{ agente.name }}</h2>
            <div id="chart-{{ forloop.counter }}"></div>
            <script>
                var options{{ forloop.counter }} = {
                    chart: {
                        type: 'bar',
                        height: 300
                    },
                    series: [
                        { name: 'ACA', data: {{ agente.aca|safe }} },
                        { name: 'Act ACA', data: {{ agente.act_aca|safe }} },
                        { name: 'Supp', data: {{ agente.supp|safe }} },
                        { name: 'Act Supp', data: {{ agente.act_supp|safe }} },
                        { name: 'Total', data: {{ agente.total|safe }} }
                    ],
                    xaxis: {
                        categories: {{ weekRanges|safe }},
                        title: { text: 'Semanas' }
                    },
                    yaxis: {
                        title: { text: 'Ventas' }
                    },
                    title: {
                        text: '{{ agente.name }} - Ventas Semanales',
                        align: 'center'
                    }
                };
                new ApexCharts(document.querySelector("#chart-{{ forloop.counter }}"), options{{ forloop.counter }}).render();
            </script>
        </div>
    {% endfor %}
</body>
</html>
