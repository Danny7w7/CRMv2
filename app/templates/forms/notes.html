{% extends "dashboard/index.html" %}
{% load static %}
{% block head %}
    <title>Notes</title>
	<!--plugins-->
	<link href="{% static "assets/plugins/simplebar/css/simplebar.css" %}" rel="stylesheet" />
	<link href="{% static "assets/plugins/perfect-scrollbar/css/perfect-scrollbar.css" %}" rel="stylesheet" />
	<link href="{% static "assets/plugins/metismenu/css/metisMenu.min.css" %}" rel="stylesheet" />
	<link href="{% static "assets/plugins/datatable/css/dataTables.bootstrap5.min.css" %}" rel="stylesheet" />
	<!-- loader-->
	<link href="{% static "assets/css/pace.min.css" %}" rel="stylesheet" />
	<script src="{% static "assets/js/pace.min.js" %}"></script>
	<!-- Bootstrap CSS -->
	<link href="{% static "assets/css/bootstrap.min.css" %}" rel="stylesheet">
	<link href="{% static "assets/css/bootstrap-extended.css" %}" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&amp;display=swap" rel="stylesheet">
	<link href="{% static "assets/css/app.css" %}" rel="stylesheet">
	<link href="{% static "assets/css/icons.css" %}" rel="stylesheet">
	<!-- Theme Style CSS -->
	<link rel="stylesheet" href="{% static "assets/css/dark-theme.css" %}" />
	<link rel="stylesheet" href="{% static "assets/css/semi-dark.css" %}" />
	<link rel="stylesheet" href="{% static "assets/css/header-colors.css" %}" />
{% endblock %}
{% block page_content %}

<div class="row row-cols-1 row-cols-md-1  ">
    <div class="col">
        <h6 class="mb-0 text-uppercase">Notes</h6>
        <hr/>
        <div class="card">
            <div class="card-body">
                <ul class="nav nav-tabs nav-primary" role="tablist">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link active" data-bs-toggle="tab" href="#one" role="tab" aria-selected="true">
                            <div class="d-flex align-items-center">
                                <div class="tab-title">Note 1</div>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" data-bs-toggle="tab" href="#two" role="tab" aria-selected="false">
                            <div class="d-flex align-items-center">
                                <div class="tab-title">Note 2</div>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" data-bs-toggle="tab" href="#three" role="tab" aria-selected="false">
                            <div class="d-flex align-items-center">
                                <div class="tab-title">Note 3</div>
                            </div>
                        </a>
                    </li>
                </ul>
                <div class="tab-content py-3">

                    <div class="tab-pane fade show active" id="one" role="tabpanel">
                        <textarea class="form-control note-input" rows="15"  style="resize: none" data-type="one">{{ notes.one }}</textarea>
                    </div>

                    <div class="tab-pane fade" id="two" role="tabpanel">
                        <textarea class="form-control note-input" rows="15"  style="resize: none" data-type="two">{{ notes.two }}</textarea>
                    </div>

                    <div class="tab-pane fade" id="three" role="tabpanel">
                        <textarea class="form-control note-input" rows="15"  style="resize: none" data-type="three">{{ notes.three }}</textarea>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}
{% block end_js %}
	<!-- Bootstrap JS -->
	<script src="{% static "assets/js/bootstrap.bundle.min.js" %}"></script>
	<!--plugins-->
	<script src="{% static "assets/js/jquery.min.js" %}"></script>
	<script src="{% static "assets/plugins/simplebar/js/simplebar.min.js" %}"></script>
	<script src="{% static "assets/plugins/metismenu/js/metisMenu.min.js" %}"></script>
	<script src="{% static "assets/plugins/perfect-scrollbar/js/perfect-scrollbar.js" %}"></script>
	<script src="{% static "assets/plugins/datatable/js/jquery.dataTables.min.js" %}"></script>
	<script src="{% static "assets/plugins/datatable/js/dataTables.bootstrap5.min.js" %}"></script>

	<!--app JS-->
	<script src="{% static "assets/js/app.js" %}"></script>

    <script>
        let timer;

        document.querySelectorAll(".note-input").forEach(textarea => {
            textarea.addEventListener("keyup", function() {

                clearTimeout(timer);
                let content = this.value;
                let note_type = this.getAttribute("data-type");

                timer = setTimeout(() => {
                    fetch("/saveNote/", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "X-CSRFToken": "{{ csrf_token }}"
                        },
                        body: JSON.stringify({
                            note_type: note_type,
                            content: content
                        })
                    })
                }, 800); // Guarda despu√©s de 0.8s sin escribir
            });
        });
    </script>

{% endblock %}